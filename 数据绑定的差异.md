# 小程序数据绑定

## 1.Create(创建)

1. Vue

   1. 在配置对象中,添加data函数,该函数返回一个对象

   2. **面试题:请问为什么Vue的data属性,必须是一个函数?**

      1. ```vue
         //app.vue
         <template>
         	<A/>
         	<A/>
         	<A/>
         </template>
         
         <script>
         //A文件暴露出来的东西,经过加工,最终会变成能够生成A组件实例对象的构造函数  
         import A from './A.vue';
         
         export default{
           components:{
             A
           }
         }
         </script>
         ```

      2. **如果data属性是一个对象,那么该对象会被当前组件构造函数创建的所有实例对象共享,具有类似Vuex的效果,但是data一般用于存放当前组件实例独享的数据,所以将data写成函数形式,这样才能保证每个组件实例都具有自己的data对象**

      3. **data函数就是一个工厂函数**

2. React

   1. 在组件类中,添加state属性,属性值为一个对象

3. 小程序

   1. 在配置对象中,添加data属性,属性值为一个对象
   2. **面试题:为什么小程序不需要像Vue一样将data写为函数形式?**
      1. **小程序在加载组件时,会将data中的对象以json形式进行深拷贝,保证每次得到的对象都是唯一的,不会出现与其他实例共享对象的情况**

## 2.Read(读取)

1. 在模版中读取
   1. Vue
      1. 在template中直接使用{{msg}}(插值语法)进行展示即可
      2. 需要将状态数据显示为文本内容,就需要使用插值语法
   2. React
      1. 在render函数中,使用{this.state.msg}进行展示即可
   3. 小程序
      1. **在wxml中直接使用{{msg}}(插值语法)进行展示即可**
      2. **注意:只要想在wxml中使用data中的数据都必须加上插值语法**
2. 在js中读取
   1. Vue
      1. 语法:this.msg -> 触发数据代理的get方法 -> this.$data.msg -> 触发数据劫持的get方法 -> 将使用闭包缓存的属性值进行返回
      2. 此流程中,可以看出Vue具有数据代理和数据劫持
   2. React
      1. 语法:this.state.msg
      2. React没有数据代理,所以只能通过this找到state对象进行读取
   3. **小程序**
      1. **语法:this.data.msg**
      2. **小程序也没有数据代理,所以只能通过this找到data对象进行读取**

## 3.Update(更新)

1. Vue
   1. 语法:this.msg=123;
   2. 流程:
      1. 触发数据代理(this.$data.msg=123)
      2. 触发数据劫持(defineProperty,set方法触发)
      3. 触发视图更新(dep.notify)
   3. **面试题:请问Vue更新数据是同步更新还是异步更新?**
      1. **同步更新**
   4. **面试题2:请问Vue更新视图是同步更新还是异步更新?**
      1. **异步更新**
2. React(持久化状态框架)
   1. 语法:this.setState({msg:123});
   2. 面试题:setState更新数据是同步更新还是异步更新?
      1. 他有可能是同步,也有可能是异步（本身是同步的，但引发后续更新状态的动作是“异步”的）
      2. 同步（非react控制的异步回调中的更新动作）
         1. 定时器回调
         2. 原生DOM事件回调
      3. 异步（react控制的回调中的更新动作）
         1. 生命周期钩子函数
         2. 合成事件
            1. 扩展:如何区分合成事件和原生DOM事件
               1. 事件名称如果是驼峰命名法,那么就是合成事件
               2. 原生事件是亲儿子,合成事件是捡来的,其实合成事件用到了事件委托原理实现(所以触发速度会比原生事件更慢)
3. 小程序(持久化状态框架)
   1. **语法:this.setData({msg:123})**
   2. **面试题:请问小程序更新数据是同步更新还是异步更新?**
      1. **同步更新**
      2. **注意:由于数据是同步更新,所以任何时候读取data中的数据,都一定能够得到当前最新数据**
   3. **面试题2:请问小程序更新视图是同步更新还是异步更新?**
      1. **异步更新**
   4. **注意:小程序没有数据代理,也没有数据劫持,总结小程序没有响应式特点**
4. 总结:无论是Vue,React还是小程序,更新视图一定是异步操作,类似于对视图更新进行了防抖操作

## 4.Delete(删除)

1. Vue
   1. Vue.delete或者this.$set来删除对应属性,最终页面会重新渲染展示删除之后的结果

## 5.数据流向

1. Vue
   1. 单向数据流
   2. 双向数据绑定v-model (伪双向)
      1. 将data中的数据作为默认值,展示在input框中
      2. 当input框内容发生变化时,同步修改data中的状态数据
2. React
   1. 单向数据流
3. 小程序
   1. 单向数据流