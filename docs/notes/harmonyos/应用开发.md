# 鸿蒙应用开发

> - [HarmonyOS官网_操作系统 || 应用 || 设备开发](https://www.harmonyos.com/cn/develop)
> - [HarmonyOS应用开发官网 - 华为HarmonyOS打造全场景新服务](https://developer.harmonyos.com/)
> - [黑马 鸿蒙HarmonyOS4.0开发视频教程（含DevEco Studio、ArkTS、ArkUI、鸿蒙项目实战等）_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1Sa4y1Z7B1/?spm_id_from=333.337.search-card.all.click)
> -  先看指南 -> Api参考



## 基础入门



### 应用结构

- [HarmonyOS Design  设计工具](https://developer.harmonyos.com/cn/design)
- [ArkTS 语言 - HarmonyOS应用开发语言](https://developer.harmonyos.com/cn/develop/arkts/)
- [声明式UI框架ArkUI_跨端界面应用开发 - HarmonyOS应用开发](https://developer.harmonyos.com/cn/develop/arkUI/)
- [方舟编译器ArkCompiler-HarmonyOS SDK-HarmonyOS应用开发](https://developer.harmonyos.com/cn/develop/arkCompiler/)：将代码编译为字节码，从而提升运行效率
- [HUAWEI DevEco Studio和SDK](https://developer.harmonyos.com/cn/develop/deveco-studio/)：代码开发工具
- [DevEco Service  ](https://devecoservice.harmonyos.com/#deveco-testing)：测试工具
- [AppGallery Connect | 移动场景服务 | 移动应用开发 | 华为开发者联盟 (huawei.com)](https://developer.huawei.com/consumer/cn/agconnect)



### 开发异同

- 类似于React+Jquery的写法，一个文件中同时包含html、css、js
- 采用 TypeScript 语法
- 使用特定开发工具
  - [配置开发环境-快速开始-DevEco Studio使用指南](https://developer.harmonyos.com/cn/docs/documentation/doc-guides-V3/environment_config-0000001052902427-V3)

![3ecb36e889087dd73ba06ec93f4650a](images/应用开发/3ecb36e889087dd73ba06ec93f4650a.jpg)

![d80d964746df534f2a933f2b472aca4](images/应用开发/d80d964746df534f2a933f2b472aca4.jpg)





### 开发范式

![image-20231205084543946](images/应用开发/image-20231205084543946.png)







### 开发目录

#### [应用配置文件（Stage模型）](https://developer.harmonyos.com/cn/docs/documentation/doc-guides-V3/application-configuration-file-overview-stage-0000001428061460-V3)

> 在基于Stage模型开发的应用项目代码下，都存在一个app.json5及一个或多个module.json5这两种配置文件。
>
> - app.json5
>   - 应用的全局配置信息，包含应用的包名、开发厂商、版本号等基本信息。
>   - 特定设备类型的配置信息
> - module.json5
>   - Module的基本配置信息，例如Module名称、类型、描述、支持的设备类型等基本信息。
>   - [应用组件](https://developer.harmonyos.com/cn/docs/documentation/doc-guides-V3/stage-model-development-overview-0000001427744552-V3)信息，包含UIAbility组件和ExtensionAbility组件的描述信息。
>   - 应用运行过程中所需的权限信息。





#### [资源分类与访问](https://developer.harmonyos.com/cn/docs/documentation/doc-guides-V3/resource-categories-and-access-0000001711674888-V3#ZH-CN_TOPIC_0000001711674888__系统资源)

> stage模型多工程情况下，共有的资源文件放到AppScope下的resources目录。





#### TS基础

![66afca38fa472e3e11ed7650f5856d2](images/应用开发/66afca38fa472e3e11ed7650f5856d2.jpg)

![c31c0977ec09f38d802bdccb2a1dd34](images/应用开发/c31c0977ec09f38d802bdccb2a1dd34.jpg)

![0005946c6848c49db6d975b57daa287](images/应用开发/0005946c6848c49db6d975b57daa287.jpg)

![b64beae80e1788b415705a39fd3cf2b](images/应用开发/b64beae80e1788b415705a39fd3cf2b.jpg)





### [ArkTS语言](https://developer.harmonyos.com/cn/docs/documentation/doc-guides-V3/arkts-get-started-0000001504769321-V3)

> 在保持TypeScript 语法风格的基础上，对TS的动态类型特性施加更严格的约束，引入静态类型。同时，提供了声明式UI、状态管理等相应的能力，让开发者可以以更简洁、更自然的方式开发高性能应用。
>
> - [基于ArkTS的声明式开发范式](https://developer.harmonyos.com/cn/docs/documentation/doc-references-V3/ts-components-summary-0000001478181369-V3)





#### 装饰器

> 装饰器： 用于装饰类、结构、方法以及变量，并赋予其特殊的含义 

- @Component： 装饰自定义组件，

  > **仅**能装饰 `struct关键字`声明的数据结构，装饰后则具备组件的能力，且一个struct只能被一个@Component装饰，通过build方法描述UI

- @Entry：装饰入口组件，使作为单独的页面使用

  > @Entry装饰的自定义组件将作为UI页面的入口。在单个UI页面中，最多可以使用@Entry装饰一个自定义组件。@Entry可以接受一个可选的[LocalStorage](https://developer.harmonyos.com/cn/docs/documentation/doc-guides-V3/arkts-localstorage-0000001524537149-V3)的参数

```js
@State		// 响应式变量（状态变量），装饰，能够引起界面刷新
```



#### 其它

> - [UI描述](https://developer.harmonyos.com/cn/docs/documentation/doc-guides-V3/arkts-declarative-ui-description-0000001524416537-V3)：以声明式的方式来描述UI的结构，例如build()方法中的代码块。
> - [自定义组件](https://developer.harmonyos.com/cn/docs/documentation/doc-guides-V3/arkts-create-custom-components-0000001473537046-V3)：可复用的UI单元，可组合其他组件
> - 系统组件：ArkUI框架中默认内置的基础和容器组件，可直接调用，例：Column、Text、Divider、Button。
> - 属性方法：组件可链式调用配置多项属性，如fontSize()、width()、height()、backgroundColor()等。
> - 事件方法：组件可以通过链式调用设置多个事件的响应逻辑，onClick()
> - 系统组件、属性方法、事件方法具体使用可参考[基于ArkTS的声明式开发范式](https://developer.harmonyos.com/cn/docs/documentation/doc-references-V3/ts-components-summary-0000001478181369-V3)。
> -  
> - 扩展的多种语法规范
>   - [@Builder](https://developer.harmonyos.com/cn/docs/documentation/doc-guides-V3/arkts-builder-0000001524176981-V3)/[@BuilderParam](https://developer.harmonyos.com/cn/docs/documentation/doc-guides-V3/arkts-builderparam-0000001524416541-V3)：特殊的封装UI描述的方法，细粒度的封装和复用UI描述。
>   - [@Extend](https://developer.harmonyos.com/cn/docs/documentation/doc-guides-V3/arkts-extend-0000001473696678-V3)/[@Style](https://developer.harmonyos.com/cn/docs/documentation/doc-guides-V3/arkts-style-0000001473856690-V3)：扩展内置组件和封装属性样式，更灵活地组合内置组件。
>   - [stateStyles](https://developer.harmonyos.com/cn/docs/documentation/doc-guides-V3/arkts-statestyles-0000001482592098-V3)：多态样式，可以依据组件的内部状态的不同，设置不同样式。

```js
// 自定义组件  - 使用 @Component 装饰的组件对象
struct Hello {
	// ...自定义组件内容
}

// UI 描述
build(){
    // ... UI 相关内容，类比 react中的 render return，Vue中的template
    // build()函数用于定义自定义组件的声明式UI描述，自定义组件必须定义build()函数
}

```





#### 使用说明

- 组件传参，变量或表达式也可以用于参数赋值，其中表达式返回的结果类型必须满足参数类型要求

  ```js
  Image(this.imagePath)
  Image('https://' + this.imageUrl)
  Text(`count: ${this.count}`)
  ```

- 属性方法，除了直接传递常量参数外，也可以传递变量或表达式

  ```js
  Text('hello')
    .fontSize(this.size)
  Image('test.jpg')
    .width(this.count % 2 === 0 ? 100 : 200)    
    .height(this.offset + 100)
  ```

- 事件方法，推荐箭头函数，

  > 匿名函数、组件成员函数 需要使用bind(),以确保函数体中的this指向当前组件

  ```js
  Button('add counter')
    .onClick(function(){  this.counter += 2; }.bind(this))	// 箭头函数
  	
  Button('Click me')
    .onClick(() => { this.myText = 'ArkUI';  })		// 匿名函数
  
  
  myClickHandler(): void { this.counter += 2; }
  Button('add counter')
    .onClick(this.myClickHandler.bind(this))			// 组件的成员函数
  ```






#### 自定义组件

> - 可组合：允许开发者组合使用系统组件、及其属性和方法。
> - 可重用：自定义组件可以被其他组件重用，并作为不同的实例在不同的父组件或容器中使用。
> - 数据驱动UI更新：通过状态变量的改变，来驱动UI的刷新。

- 自定义组件名、类名、函数名不能和系统组件名相同
- 自定义组件必须定义build()函数，用于定义声明式UI描述
- @Entry装饰的自定义组件，其**build()函数下的根节点唯一**且必要，**且必须为容器组件**，其中ForEach禁止作为根节点
- @Component装饰的自定义组件，其**build()函数下的根节点唯一**且必要，**可以为非容器组件**，其中ForEach禁止作为根节点
- **自定义组件成员函数约束**：不支持静态函数   ||    成员函数的访问是私有的
- **自定义组件成员变量约束**：
  - 不支持静态成员变量
  - 所有成员变量的访问都是私有的
  - 成员变量本地初始化有些是可选的，有些是必选的，[（状态管理）](https://developer.harmonyos.com/cn/docs/documentation/doc-guides-V3/arkts-state-management-overview-0000001524537145-V3)
- `build()`函数约束
  - **不能直接** 【声明本地变量、console打印、使用 `{}`】

```js
// 自定义组件的基本结构 - 基于struct实现，不能有继承关系
@Component
struct MyComponent {
   build() {
   }
}


// 示例：初始化自定义组件的值
@Component
struct MyComponent {
  private countDownFrom: number = 0;
  private color: Color = Color.Blue;

  build() {
  }
}

@Entry
@Component
struct ParentComponent {
  private someColor: Color = Color.Pink;

  build() {
    Column() {
      // 创建MyComponent实例，并将创建MyComponent成员变量countDownFrom初始化为10，将成员变量color初始化为this.someColor
      MyComponent({ countDownFrom: 10, color: this.someColor })
    }
  }
}


// 示例： 关于根节点的约束
@Entry
@Component
struct MyComponent {
  build() {
    // 入口组件中，根节点唯一且必要，且必须为容器组件，ForEach禁止作为根节点
    Row() {
      ChildComponent() 
    }
  }
}

@Component
struct ChildComponent {
  build() {
    // 非入口组件，根节点唯一且必要，可为非容器组件，ForEach可作为根节点
    Image('test.jpg')
  }
}
```





![0872ceb1f8ef3f58bfdc8bbe2c8bf83](images/应用开发/0872ceb1f8ef3f58bfdc8bbe2c8bf83.jpg)

![9bbc7f48b824f6431fc2203f7bbc5a1](images/应用开发/9bbc7f48b824f6431fc2203f7bbc5a1.jpg)

![34b8263b3d6f2d2e05dab94da4e4afe](images/应用开发/34b8263b3d6f2d2e05dab94da4e4afe.jpg)

![cd8597d7b032b0d780fdef8ffd1fd86](images/应用开发/cd8597d7b032b0d780fdef8ffd1fd86.jpg)

![312a18848a532e196eb6e0fd0f9ca94](images/应用开发/312a18848a532e196eb6e0fd0f9ca94.jpg)

![1ae0e3c0d23dbb83b26008d5a40b8a7](images/应用开发/1ae0e3c0d23dbb83b26008d5a40b8a7.jpg)









#### [@ohos.router (页面路由)](https://developer.harmonyos.com/cn/docs/documentation/doc-references-V3/js-apis-router-0000001478061893-V3)

> 页面路由栈支持的最大Page数量为32。
>
> - url
>   - 页面绝对路径，由配置文件中pages列表提供，例如：pages/index/index
>   - 如果url的值是"/"，则跳转到首页
> - params
>   - 使用router.getParams()获取传递的参数;在类web范式中，参数也可以在页面中直接使用，如this.keyValue(keyValue为跳转时params参数中的key值)，如果目标页面中已有该字段，则其值会被传入的字段值覆盖。
>   - params参数不能传递方法和系统接口返回的对象（params参数不能传递方法和系统接口返回的对象）；params参数不能传递方法和系统接口返回的对象。

- `router.pushUrl({}).then(()=>{}).catch(()=>{})`
- `router.replaceUrl`
- `router.back({url:'pages/detail'});   `    // 返回上一页面或指定的页面
- `router.clear()`    // 清空页面栈中的所有历史页面，仅保留当前页面作为栈顶页面。
- `let size = router.getLength();    `   // 获取当前在页面栈内的页面数量。
- `let page = router.getState();`     // 获取当前页面的状态信息
- `router.getParams();`     // 获取发起跳转的页面往当前页传入的参数。
- `router.showAlertBeforeBackPage({message: 'Message Info'})`   // 开启页面返回询问对话框。

```ts
// 导入路由模块
import router from '@ohos.router'

// 跳转到应用内的指定页面
router.pushUrl({
  url: 'pages/routerpage2',
  params: {
    data1: 'message',
    data2: {
      data3: [123, 456, 789]
    }
  }
})
  .then(() => {
    // success
  })
  .catch(err => {
    console.error(`pushUrl failed, code is ${err.code}, message is ${err.message}`);
  })


// 用应用内的某个页面替换当前页面，并销毁被替换的页面。不支持设置页面转场动效，如需设置，推荐使用Navigation组件。
router.replaceUrl({
  url: 'pages/detail',
  params: {
    data1: 'message'
  }
})
  .then(() => {
    // success
  })
  .catch(err => {
    console.error(`replaceUrl failed, code is ${err.code}, message is ${err.message}`);
  })
```





![1653787737f939a123ca48787b2061e](images/应用开发/1653787737f939a123ca48787b2061e.jpg)





s













