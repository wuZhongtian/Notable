# ç›¸å…³çŸ¥è¯†

## æ¡†æ¶é¢

### SPA å•é¡µåº”ç”¨

- æµè§ˆå™¨ä¸€å¼€å§‹å°±åŠ è½½å¿…é¡»çš„ HTMLã€CSSã€JSï¼Œæ‰€æœ‰çš„æ“ä½œåœ¨å•ä¸ªé¡µé¢ä¸Šå®Œæˆï¼Œç”± JS æ§åˆ¶äº¤äº’å’Œå±€éƒ¨åˆ·æ–°
- ä¼˜ç‚¹ï¼š
  - å‰åç«¯åˆ†ç¦»ã€è‰¯å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œä¸åˆ·æ–°ç•Œé¢ï¼Œæ˜¾ç¤ºæ›´æµç•…
  - å‡è½»æœåŠ¡å™¨å‹åŠ›ï¼Œä¸éœ€è¦é¢‘ç¹è¯·æ±‚ç•Œé¢
- ç¼ºç‚¹ï¼šåˆæ¬¡åŠ è½½æ¯”è¾ƒè€—æ—¶ã€ä¸”ä¸åˆ©äº SEO ä¼˜åŒ–

### SSR ä¸ CSR

- SSR(Server-Side Rendering) ï¼šæœåŠ¡ç«¯ç›´æ¥æŠŠæ¸²æŸ“åçš„é¡µé¢å‘é€ç»™å®¢æˆ·ç«¯ï¼Œæå‡é¡µé¢å“åº”é€Ÿåº¦ã€‚
  - æ¡†æ¶ï¼š
    - åŸºäº Vue çš„ï¼šNuxtã€[VitePress](https://vitepress.dev/zh/)ã€[VuePress](https://v2.vuepress.vuejs.org/zh/)
    - åŸºäº React çš„ï¼šNextã€[Docusaurus](https://www.docusaurus.cn/)ã€[Docsify](https://docsify.js.org/#/)ã€Remix
  - ç‰¹ç‚¹ï¼š
    - ä¸éœ€è¦ SPA ä¸­çš„ç­‰å¾…é¡µé¢åŠ è½½ > æ‰§è¡Œ JS > åŠ è½½æ•°æ® > æ¸²æŸ“åˆ°ç½‘é¡µ
    - ä¼˜ç‚¹ï¼šæå‡æ€§èƒ½ã€SEO ä¼˜åŒ–å‹å¥½
    - éœ€è¦éƒ¨ç½²å¹¶è¿è¡Œåœ¨æœåŠ¡å™¨ï¼Œæ— æ³•è¿è¡Œåœ¨é™æ€ç©ºé—´
  - ä¸€èˆ¬æ„æˆï¼š
    - æœåŠ¡å™¨ç«¯åº”ç”¨ç¨‹åºï¼šè¿è¡ŒæœåŠ¡å™¨ä¸Šçš„åº”ç”¨ç¨‹åºï¼Œ**ä¸èƒ½ç›´æ¥è¿è¡Œåœ¨é™æ€ç©ºé—´**ï¼Œéœ€è¦ä½¿ç”¨ Node.js è¿è¡Œï¼›è´Ÿè´£æ¥æ”¶è¯·æ±‚ã€æ‰§è¡Œæ¸²æŸ“è¿‡ç¨‹å¹¶è¿”å›é¡µé¢
    - è·¯ç”±ï¼šéœ€è¦æ ¹æ®å®¢æˆ·ç«¯è¯·æ±‚çš„ä¸åŒè·¯å¾„ï¼Œè°ƒç”¨å¯¹åº”çš„æ¸²æŸ“é€»è¾‘å’Œæ•°æ®è·å–æ–¹æ³•
    - æ¨¡æ¿å¼•æ“ï¼šç”¨äºå°†é¡µé¢æ¨¡æ¿å’Œæ•°æ®ç»“åˆï¼Œæœ€ç»ˆç”Ÿæˆ HTML å†…å®¹ï¼ŒåŸºäºæŸç§ MVVM æ¡†æ¶
    - æ•°æ®è·å–ï¼šæœåŠ¡ç«¯è·å–åˆæ¬¡æ¸²æŸ“éœ€è¦çš„æ•°æ®ï¼Œå’Œç”¨æˆ·ä¿¡æ¯ç­‰éœ€è¦å‰ç«¯è·å–çš„æ•°æ®ï¼Œå¯èƒ½æ¶‰åŠæ•°æ®åº“ã€API æˆ–å…¶ä»–æ¥æºçš„æ•°æ®
    - çŠ¶æ€ç®¡ç†ï¼šéœ€è¦è€ƒè™‘å¦‚ä½•ç®¡ç†å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨çš„çŠ¶æ€åŒæ­¥ï¼Œé¿å…å‡ºç°ä¸ä¸€è‡´çš„æƒ…å†µ
    - å®¢æˆ·ç«¯äº¤äº’ï¼šåœ¨é¡µé¢åˆæ¬¡æ¸²æŸ“ä¹‹åï¼Œå®¢æˆ·ç«¯ä»è¦è¿›è¡Œäº¤äº’ï¼Œå¦‚ä½•ä½¿ç”¨ JS æ·»åŠ åŠ¨æ€å†…å®¹æˆ–å¤„ç†ç”¨æˆ·æ“ä½œ
- CSR(Client Side Rendering)ï¼šä¾èµ–è¿è¡Œåœ¨å®¢æˆ·ç«¯çš„ JSï¼Œç”¨æˆ·é¦–æ¬¡å‘é€è¯·æ±‚åªèƒ½å¾—åˆ°å°éƒ¨åˆ†çš„æŒ‡å¼•æ€§ HTML ä»£ç ã€‚ç¬¬äºŒæ¬¡è¯·æ±‚å°†ä¼šè¯·æ±‚æ›´å¤šåŒ…å« HTML å­—ç¬¦ä¸²çš„ JS æ–‡ä»¶
- https://juejin.cn/post/7039151040188383268

![image-20230330093208475](images/å…¶ä»–æ¦‚å¿µ/image-20230330093208475.png)

### MVC ä¸ MVVM

- MVCï¼š

  > åœ¨ä¼ ç»Ÿçš„éå‰åç«¯åˆ†ç¦»é¡¹ç›®ä¸­ï¼Œåç«¯éœ€è¦å¤„ç†å¤§é‡çš„å†…å®¹ï¼Œå¦‚æœä¸æŒ‰ç…§ä¸€å®šçš„æ¨¡å¼å°±æ˜¯"å¤§ä¹±ç‚–"
  >
  > æ¨¡å‹ Mï¼è§†å›¾(ç”¨æˆ·ç•Œé¢) V - æ§åˆ¶å™¨ C

  - C å³ controller æ§åˆ¶å™¨ï¼šæ¥å—ç”¨æˆ·çš„è¾“å…¥å¹¶è°ƒç”¨æ¨¡å‹å’Œè§†å›¾å»å®Œæˆç”¨æˆ·çš„éœ€æ±‚ï¼Œæ§åˆ¶å™¨æœ¬èº«ä¸è¾“å‡ºä»»ä½•ä¸œè¥¿å’Œåšä»»ä½•å¤„ç†ã€‚å®ƒåªæ˜¯æ¥æ”¶è¯·æ±‚å¹¶å†³å®šè°ƒç”¨å“ªä¸ªæ¨¡å‹æ„ä»¶å»å¤„ç†è¯·æ±‚ï¼Œç„¶åå†ç¡®å®šç”¨å“ªä¸ªè§†å›¾æ¥æ˜¾ç¤ºè¿”å›çš„æ•°æ®ã€‚
  - V å³ View è§†å›¾ï¼šæŒ‡ç”¨æˆ·çœ‹åˆ°å¹¶ä¸ä¹‹äº¤äº’çš„ç•Œé¢ã€‚æ¯”å¦‚ç”± html å…ƒç´ ç»„æˆçš„ç½‘é¡µç•Œé¢ï¼Œæˆ–è€…è½¯ä»¶çš„å®¢æˆ·ç«¯ç•Œé¢ã€‚MVC çš„å¥½å¤„ä¹‹ä¸€åœ¨äºå®ƒèƒ½ä¸ºåº”ç”¨ç¨‹åºå¤„ç†å¾ˆå¤šä¸åŒçš„è§†å›¾ã€‚åœ¨è§†å›¾ä¸­å…¶å®æ²¡æœ‰çœŸæ­£çš„å¤„ç†å‘ç”Ÿï¼Œå®ƒåªæ˜¯ä½œä¸ºä¸€ç§è¾“å‡ºæ•°æ®å¹¶å…è®¸ç”¨æˆ·æ“ä½œçš„æ–¹å¼ã€‚
  - M å³ model æ¨¡å‹ï¼šæŒ‡ä¸šåŠ¡è§„åˆ™ã€‚åœ¨ MVC çš„ä¸‰ä¸ªéƒ¨ä»¶ä¸­ï¼Œæ¨¡å‹æ‹¥æœ‰æœ€å¤šçš„å¤„ç†ä»»åŠ¡ã€‚è¢«æ¨¡å‹è¿”å›çš„æ•°æ®æ˜¯ä¸­ç«‹çš„ï¼Œæ¨¡å‹ä¸æ•°æ®æ ¼å¼æ— å…³ï¼Œè¿™æ ·ä¸€ä¸ªæ¨¡å‹èƒ½ä¸ºå¤šä¸ªè§†å›¾æä¾›æ•°æ®ï¼Œç”±äºåº”ç”¨äºæ¨¡å‹çš„ä»£ç åªéœ€å†™ä¸€æ¬¡å°±å¯ä»¥è¢«å¤šä¸ªè§†å›¾é‡ç”¨ï¼Œæ‰€ä»¥å‡å°‘äº†ä»£ç çš„é‡å¤æ€§ã€‚

  ![image-20220419204329588](images/å…¶ä»–æ¦‚å¿µ/image-20220419204329588.png)

- MVVM

  > ç”±åç«¯çš„ MVC æ¶æ„æ¼”åŒ–è€Œæ¥ï¼Œä¼ ç»Ÿçš„ MVC å¹¶ä¸ç¬¦åˆå‰ç«¯çš„å®é™…éœ€æ±‚
  >
  > åˆ’åˆ†ä»£ç èŒè´£ï¼šåŸæœ¬éœ€è¦å‘æ•°æ®ã€å­˜æ•°æ®ã€æ‹¼æ¨¡æ¿ã€æ¸²æŸ“ DOM...ï¼ˆå¤§ä¹±ç‚–ï¼‰
  >
  > - Model æ¨¡å‹ï¼šå¯¹åº” Vue data ä¸­çš„æ•°æ®
  > - View è§†å›¾ï¼šæ¨¡æ¿
  > - ViewModel è§†å›¾æ¨¡å‹ï¼švue å®ä¾‹å¯¹è±¡ï¼Œ æ˜¯ View ä¸ Model çš„ç»“åˆ

  - ä¼˜ç‚¹ï¼š
    - å°†è§†å›¾ UI å’Œä¸šåŠ¡é€»è¾‘åˆ†å¼€
    - **ä½è€¦åˆ**ã€‚è§†å›¾ï¼ˆViewï¼‰å¯ä»¥ç‹¬ç«‹äº Model å˜åŒ–å’Œä¿®æ”¹ï¼Œä¸€ä¸ª ViewModel å¯ä»¥ç»‘å®šåˆ°ä¸åŒçš„"View"ä¸Šï¼Œå½“ View å˜åŒ–çš„æ—¶å€™ Model å¯ä»¥ä¸å˜ï¼Œå½“ Model å˜åŒ–çš„æ—¶å€™ View ä¹Ÿå¯ä»¥ä¸å˜ã€‚
    - **å¯é‡ç”¨æ€§**ã€‚ä½ å¯ä»¥æŠŠä¸€äº›è§†å›¾é€»è¾‘æ”¾åœ¨ä¸€ä¸ª ViewModel é‡Œé¢ï¼Œè®©å¾ˆå¤š view é‡ç”¨è¿™æ®µè§†å›¾é€»è¾‘ã€‚
    - å®ç°æ•°æ®çš„åŒå‘ç»‘å®šï¼š
      - ä¿®æ”¹æ•°æ® M => è§†å›¾è‡ªåŠ¨æ”¹å˜
      - ä¿®æ”¹è§†å›¾ V => æ•°æ®è‡ªåŠ¨æ”¹å˜

![image-20220419204639547](images/å…¶ä»–æ¦‚å¿µ/image-20220419204639547.png)

## æŠ€å·§æ–¹æ³•

#### ä»£ç æ··æ·†

> - [JavaScript æ··æ·†/åŠ å¯† | èœé¸Ÿå·¥å…· (jyshare.com)](https://www.jyshare.com/front-end/6939/)

#### å˜é‡å‘½åç®¡ç†

> ä¾¿äºé¡¹ç›®ç®¡ç†çš„åŒæ—¶é¿å…ç¼–ç æ—¶å†™é”™å•è¯

- åˆ›å»º constant.js æ–‡ä»¶
- const å®šä¹‰å˜é‡å¹¶å¯¼å‡º `export const INCREMENT = 'increment'`
  - å½“éœ€è¦æ›´æ¢å˜é‡åæ—¶ï¼Œåªéœ€ä¿®æ”¹ä¸€å¤„
- ä½¿ç”¨æ—¶å¯¼å…¥éœ€è¦çš„å˜é‡å³å¯ `import {INCREMENT} from './constant'`

#### ä¸»é¢˜è‰²è®¾ç½®

> [ä¸€æ–‡ææ‡‚å‰ç«¯å¤šä¸»é¢˜é€‚é…æ–¹æ¡ˆ - æ˜é‡‘ (juejin.cn)](https://juejin.cn/post/7049384448256639006)
>
> å‰ç«¯å¸¸è§æ–¹æ¡ˆï¼š
>
> - ä½¿ç”¨æµè§ˆå™¨é»˜è®¤ä¸»é¢˜ä½œä¸ºé»˜è®¤ä¸»é¢˜è‰²ï¼Œç›‘å¬æµè§ˆå™¨çš„ä¸»é¢˜ä½¿ç”¨ã€‚
> - åç»­æ ¹æ®ç”¨æˆ·åœ¨ç•Œé¢æ›´æ¢ä¸»é¢˜æŒ‰é’®ï¼Œç»“åˆæœ¬åœ°å­˜å‚¨è¿›è¡Œç‹¬ç«‹ç®¡ç†ã€‚

##### css è·å–ä¸»é¢˜è‰²

```css
/* prefers-color-scheme: dark å½“æµè§ˆå™¨æ¨¡å¼ä¸ºæ·±è‰²æ—¶ç”Ÿæ•ˆ */
@media (prefers-color-scheme: dark) {
  .day.dark-scheme {
    background: #333;
    color: white;
  }
  .night.dark-scheme {
    background: black;
    color: #ddd;
  }
}

/* prefers-color-scheme: light å½“æµè§ˆå™¨æ¨¡å¼ä¸ºæµ…è‰²æ—¶ç”Ÿæ•ˆ */
@media (prefers-color-scheme: light) {
  .day.light-scheme {
    background: white;
    color: #555;
  }
  .night.light-scheme {
    background: #eee;
    color: black;
  }
}

/* .day.dark-scheme è¡¨ç¤ºé€‰æ‹©åŒæ—¶æ‹¥æœ‰ dayã€dark-scheme ç±»åçš„æ ‡ç­¾ */
```

##### js è·å–ä¸»é¢˜è‰²

```js
const isDarkTheme = window.matchMedia("(prefers-color-scheme: dark)");
if (isDarkTheme.matches) {
  // æ˜¯æ·±è‰²
  // ä¸»é¢˜è®¾ç½®ä¸ºæ·±è‰²ã€‚
} else {
  // ä¸æ˜¯æ·±è‰²
  // ä¸»é¢˜è®¾ç½®ä¸ºæµ…è‰²ã€‚
}
```

##### æŒ‡å®šå±€éƒ¨ä¸»é¢˜

> color-scheme CSS å±æ€§å…è®¸å…ƒç´ æŒ‡ç¤ºå®ƒå¯ä»¥èˆ’é€‚åœ°å‘ˆç°å“ªäº›é¢œè‰²æ–¹æ¡ˆã€‚
>
> æ“ä½œç³»ç»Ÿé¢œè‰²æ–¹æ¡ˆçš„å¸¸è§é€‰æ‹©ä¸ºâ€œäº®è‰²â€å’Œâ€œæš—è‰²â€ï¼Œæˆ–â€œæ—¥é—´æ¨¡å¼â€å’Œâ€œå¤œé—´æ¨¡å¼â€ã€‚å½“ç”¨æˆ·é€‰æ‹©å…¶ä¸­ä¸€ç§é¢œè‰²æ–¹æ¡ˆæ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šå¯¹ç”¨æˆ·ç•Œé¢è¿›è¡Œè°ƒæ•´ï¼ŒåŒ…æ‹¬è¡¨å•æ§ä»¶ã€æ»šåŠ¨æ¡å’Œ CSS ç³»ç»Ÿé¢œè‰²çš„ä½¿ç”¨å€¼ã€‚
>
> è¯¥ css å±æ€§ï¼Œå¯ä»¥è¦†ç›–æµè§ˆå™¨çš„é»˜è®¤ä¸»é¢˜é…ç½®

```css
/* 
ç¦æ­¢ç”¨æˆ·ä»£ç†è¦†ç›–å…ƒç´ çš„é¢œè‰²æ–¹æ¡ˆã€‚
å¯ä»¥ä½¿ç”¨ color-scheme: only light; åº”ç”¨äºç‰¹å®šçš„å…ƒç´ æˆ– :rootï¼Œä»¥å…³é—­ç”± Chrome çš„è‡ªåŠ¨æ·±è‰²ä¸»é¢˜å¼•èµ·çš„é¢œè‰²è¦†ç›–ã€‚
*/
color-scheme: only light; /* æŒ‡å®šå¿…é¡»ä¸º äº®è‰² */

color-scheme: normal; /* ä½¿ç”¨æµè§ˆå™¨çš„é»˜è®¤é…è‰²æ–¹æ¡ˆ */
color-scheme: light; /* äº®è‰² */
color-scheme: dark; /* æš—è‰² */
```

##### ç›‘å¬å½“å‰ç¯å¢ƒé¢œè‰²æ¨¡å¼çš„å˜åŒ–

- [åœ¨æµè§ˆå™¨ä¸­æ£€æµ‹æ˜¯å¦ä¸ºæ·±è‰²æ¨¡å¼ - æ˜é‡‘ (juejin.cn)](https://juejin.cn/post/7080567228029992996)

```js
var mqList = window.matchMedia("(prefers-color-scheme: dark)");

mqList.addEventListener("change", (event) => {
  if (event.matches) {
    // æš—è‰²æ¨¡å¼
  } else {
    // äº®è‰²æ¨¡å¼
  }
});

// å…¼å®¹æ€§é—®é¢˜ï¼š
/*  
Safari < 14æ—¶ 
æ²¡æœ‰addEventListenerå’Œ .removeEventListener,éœ€è¦ä½¿ç”¨
MediaQueryList.addListener, å’Œ  MediaQueryList.removeListener, 
*/
/* IEä¸æ”¯æŒ */
```

#### è·å– ip åœ°å€

##### å‰ç«¯ js

```js
// è·å–ç”¨æˆ·ipåœ°å€ å€ŸåŠ©æœç‹æ¥å£
let loginIp = "";
const script = document.createElement("script");
script.src = "https://pv.sohu.com/cityjson?ie=utf-8";
script.async = true;
document.body.appendChild(script);
script.onload = () => (loginIp = window.returnCitySN["cip"]);
// {"cip": "211.142.190.47", "cid": "410000", "cname": "æ²³å—çœ"};
// loginIp ä¸ºipåœ°å€
```

##### åç«¯ node

```js
// è·å–å®¢æˆ·ç«¯ipåœ°å€
app.get("/ip", function (req, res) {
  var clientIp = getIp(req);
  console.log("å®¢æˆ·ç«¯ip", clientIp);
  res.json({ youIp: clientIp });
});
//é€šè¿‡reqçš„hearersæ¥è·å–å®¢æˆ·ç«¯ip
var getIp = function (req) {
  var ip =
    req.headers["x-real-ip"] ||
    req.headers["x-forwarded-for"] ||
    req.connection.remoteAddres ||
    req.socket.remoteAddress ||
    "";
  if (ip.split(",").length > 0) {
    ip = ip.split(",")[0];
  }
  return ip;
};
```

#### æ–‡ä»¶ä¸‹è½½æºå¸¦ token

> ä½¿ç”¨ msSaveBlob æˆ– msSaveOrOpenBlob å¯èƒ½å­˜åœ¨å…¼å®¹æ€§é—®é¢˜

```js
// å› ä¸ºå­˜åœ¨å…¼å®¹é—®é¢˜ï¼Œä½¿ç”¨å‰å»ºè®®åˆ¤æ–­ä¸€ä¸‹
if (window.navigator.msSaveOrOpenBlob) {
  navigator.msSaveBlob(blob, filename);
} else {
  // ä½¿ç”¨aæ ‡ç­¾çš„ä¸‹è½½åŠŸèƒ½ã€‚ã€‚ã€‚
}
// åˆ›å»ºå†…å®¹
var blobObject = new Blob([
  "I scream. You scream. We all scream for ice cream.",
]);
// 1.msSaveBlobï¼šåªæä¾›ä¸€ä¸ªä¿å­˜æŒ‰é’®
window.navigator.msSaveBlob(blobObject, "msSaveBlob_testFile.txt");
// 2.msSaveOrOpenBlobï¼šæä¾›ä¿å­˜å’Œæ‰“å¼€æŒ‰é’®
window.navigator.msSaveOrOpenBlob(
  blobObject,
  "msSaveBlobOrOpenBlob_testFile.txt"
);
```

> ä¸‹è½½æ–‡ä»¶ä½¿ç”¨ a æ ‡ç­¾çš„ download å±æ€§ï¼Œä½† a æ ‡ç­¾æ— æ³•è®¾ç½®è¯·æ±‚å¤´ã€è¯·æ±‚å‚æ•°

- [ä½¿ç”¨ a æ ‡ç­¾ä¸‹è½½æ–‡ä»¶æ—¶è¦è®¾ç½®è¯·æ±‚å¤´å¦‚å¸¦ä¸Šç”¨äºé‰´æƒçš„ token - ç®€ä¹¦ (jianshu.com)](https://www.jianshu.com/p/f087cdf57846)

- `<a href="æ–‡ä»¶è·¯å¾„" download="filename">`

  - æ³¨ï¼šå¦‚æœé‡åˆ°ä¸‹è½½ txtã€jpg ç­‰æ–‡ä»¶æ—¶å‡ºç°ç›´æ¥æ‰“å¼€æ–‡ä»¶è€Œä¸æ˜¯ä¸‹è½½æ–‡ä»¶çš„æƒ…å†µæ—¶ï¼Œå¯ä»¥åœ¨ä¸‹è½½åœ°å€å³ url åæ‹¼æ¥ `?response-content-type=application/octet-stream` å³å¯

- objectURL = URL.createObjectURL(fileObject) è·å–å½“å‰æ–‡ä»¶çš„ä¸€ä¸ªå†…å­˜ URL,åŒæ­¥æ‰§è¡Œ

  - å‚æ•°ï¼šç”¨äºåˆ›å»º URL çš„ File å¯¹è±¡ã€Blob å¯¹è±¡æˆ–è€… MediaSource å¯¹è±¡ã€‚

- URL.revokeObjectURL(objectURL) é‡Šæ”¾ä»–ä»¬

  - æµè§ˆå™¨åœ¨ document å¸è½½çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨é‡Šæ”¾å®ƒä»¬ï¼Œä½†æ˜¯ä¸ºäº†è·å¾—æœ€ä½³æ€§èƒ½å’Œå†…å­˜ä½¿ç”¨çŠ¶å†µï¼Œä½ åº”è¯¥åœ¨å®‰å…¨çš„æ—¶æœºä¸»åŠ¨é‡Šæ”¾

- ![image-20220914152932167](images/å…¶ä»–æ¦‚å¿µ/image-20220914152932167.png)

- ```js
  // è§£å†³æ€è·¯ï¼š
  // 1.ä½¿ç”¨xhr å‘èµ·è¯·æ±‚ï¼Œå¾—åˆ°æ–‡ä»¶æ•°æ®
  // 2.åˆ©ç”¨URL.createObjectURL() å°†xhrè·å–çš„ä¸´æ—¶æ–‡ä»¶ç”Ÿæˆ æœ¬åœ°ä¸´æ—¶åœ°å€
  // 3.ä½¿ç”¨aæ ‡ç­¾ä¸‹è½½æœ¬åœ°ä¸´æ—¶åœ°å€çš„æ–‡ä»¶ âˆš
  this.getBlob(fileUrl || file.thumbUrl).then(blob => {
     this.saveAs(blob, file.name);
   });
  
  /** è·å– blob    url ç›®æ ‡æ–‡ä»¶åœ°å€  */
  getBlob(url) {
    return new Promise(resolve => {
      const xhr = new XMLHttpRequest();
      xhr.open("GET", url, true);
      xhr.setRequestHeader("token",sessionStorage.getItem('token'));
      xhr.responseType = "blob";
      xhr.onload = () => {
        if (xhr.status === 200) {
          resolve(xhr.response);
        }
      };
      xhr.send();
    });
  },
  
  /** ä¿å­˜ blob
   * filename æƒ³è¦ä¿å­˜çš„æ–‡ä»¶åç§°   */
  saveAs(blob, filename) {
    if (window.navigator.msSaveOrOpenBlob) {
      navigator.msSaveBlob(blob, filename);
    } else {
      const link = document.createElement("a");
      const body = document.querySelector("body");
      link.href = window.URL.createObjectURL(blob);
      link.download = filename;
      // fix Firefox
      link.style.display = "none";
      body.appendChild(link);
      link.click();
      body.removeChild(link);
      window.URL.revokeObjectURL(link.href);
    }
  },
  
  // ç”¨fetchå‘é€è¯·æ±‚ å¯¹è¯·æ±‚å›æ¥çš„äºŒè¿›åˆ¶æ–‡ä»¶æµè¿›è¡Œå¤„ç†
  fetch('/upload/user.png').then((res) => {
    res.blob().then((blob) => {
      const blobUrl = window.URL.createObjectURL(blob);
      // è¿™é‡Œçš„æ–‡ä»¶åæ ¹æ®å®é™…æƒ…å†µä»å“åº”å¤´æˆ–è€…urlé‡Œè·å–
      const filename = 'user.txt';
      const a = document.createElement('a');
      a.href = blobUrl;
      a.download = filename;
      a.click();
      window.URL.revokeObjectURL(blobUrl);
    });
  });
  
  ```



#### token åˆ·æ–°å¹¶å‘å¤„ç†è§£å†³æ–¹æ¡ˆ

1. å»¶æ—¶åˆ·æ–°ï¼šåœ¨ token å³å°†è¿‡æœŸæ—¶ï¼Œå‰ç«¯é€šè¿‡å¼‚æ­¥è¯·æ±‚è·å–æ–°çš„ tokenï¼Œæ­¤æ—¶æ—§ token è¿˜å¯ä»¥ä½¿ç”¨ã€‚ç­‰åˆ°æ–° token è·å–åï¼Œå†å°†æ—§ token æ›¿æ¢æˆæ–° tokenã€‚

   é™åˆ¶è¯·æ±‚é¢‘ç‡ï¼šå‰ç«¯å¯ä»¥é™åˆ¶åˆ·æ–° token çš„è¯·æ±‚é¢‘ç‡ï¼Œé¿å…å¤šæ¬¡é‡å¤è¯·æ±‚å¯¼è‡´å¹¶å‘é—®é¢˜ã€‚å¯ä»¥è®¾ç½®ä¸€ä¸ªæ—¶é—´çª—å£ï¼Œåœ¨è¯¥æ—¶é—´çª—å£å†…åªå…è®¸åˆ·æ–°ä¸€æ¬¡ tokenã€‚

2. è½®è¯¢åˆ·æ–°ï¼šå‰ç«¯å¯ä»¥é€šè¿‡è½®è¯¢çš„æ–¹å¼å®šæ—¶è·å–æ–°çš„ tokenï¼Œä»¥ä¿è¯ token çš„å®æ—¶æ€§ã€‚å¯ä»¥è®¾ç½®è½®è¯¢æ—¶é—´é—´éš”ï¼Œé¿å…å¹¶å‘è¯·æ±‚é—®é¢˜ã€‚è€Œéè°ƒç”¨æ¥å£æ—¶è¿›è¡Œåˆ¤æ–­

3. ä½¿ç”¨é”æœºåˆ¶ï¼šå‰ç«¯å¯ä»¥ä½¿ç”¨é”æœºåˆ¶æ¥ä¿è¯åŒæ—¶åªæœ‰ä¸€ä¸ªè¯·æ±‚å¯ä»¥åˆ·æ–° tokenï¼Œå…¶ä»–è¯·æ±‚éœ€è¦ç­‰å¾…é”é‡Šæ”¾åæ‰èƒ½è¿›è¡Œåˆ·æ–°æ“ä½œã€‚å¯ä»¥ä½¿ç”¨ JavaScript çš„é”æœºåˆ¶æˆ–è€…åœ¨åç«¯è®¾ç½®é”æœºåˆ¶ã€‚ğŸ§ª

4. ä½¿ç”¨é˜Ÿåˆ—ï¼šå‰ç«¯å¯ä»¥ä½¿ç”¨é˜Ÿåˆ—æ¥æ§åˆ¶ token åˆ·æ–°è¯·æ±‚çš„é¡ºåºï¼Œé¿å…å¹¶å‘é—®é¢˜ã€‚å°†åˆ·æ–° token è¯·æ±‚æ”¾å…¥é˜Ÿåˆ—ä¸­ï¼Œæ¯æ¬¡åªå¤„ç†é˜Ÿåˆ—ä¸­çš„ä¸€ä¸ªè¯·æ±‚ï¼Œç­‰å¾…å¤„ç†å®Œåå†å¤„ç†ä¸‹ä¸€ä¸ªè¯·æ±‚ã€‚

#### å›½é™…åŒ–è¯­è¨€

- https://www.cnblogs.com/morango/p/15185442.html
- https://oldj.net/article/2019/06/15/get-the-language-of-browser/

#### ç¼–è¾‘å™¨æ³¨é‡Šè§„èŒƒ

```js
/**
 *
 * @param [eye] ä¸­æ‹¬å·è¡¨ç¤ºä¸ºå¯é€‰å€¼
 * @param [name='xiaowang'] ç­‰å·è¡¨ç¤ºï¼Œè¯¥å‚æ•°æœ‰é»˜è®¤å€¼
 */
```

![image-20230608095740537](images/å…¶ä»–æ¦‚å¿µ/image-20230608095740537.png)

#### [clsx.js æ¡ä»¶ç”¨ç±»](https://github.com/lukeed/clsx#readme)

> ä¸ classnames ç”¨æ³•ä¸€è‡´ï¼Œbut classnames é’ˆå¯¹æ‰€æœ‰æµè§ˆå™¨ï¼Œclsx ä¸»è¦é’ˆå¯¹ react ä¸­ä½¿ç”¨

- åŒååŒ…ä¸­çš„ `clsx()` å‡½æ•°æ˜¯ä¸€ä¸ª JavaScript å®ç”¨ç¨‹åºï¼Œç”¨äºè®¾ç½®è®¾ç½® `className` å±æ€§å€¼çš„æ¡ä»¶ã€‚å®ƒæ¥å—æ— é™æ•°é‡çš„å‚æ•°ï¼Œä¸é™äºä¸€ç§ç‰¹å®šç±»å‹ã€‚

- æœ€ç»ˆï¼Œ`clsx()` å‡½æ•°**è¿”å›ä¸€ä¸ª `string` æ’å€¼**ï¼Œæ£€æŸ¥ JavaScript å˜é‡çš„ `boolean` å€¼å¹¶ç›¸åº”åœ°åº”ç”¨ç±»

- ä¼šè¢«ä¸¢å¼ƒçš„å€¼

  - ```js
    clsx(true, false, "", null, undefined, 0, NaN);
    ```

```jsx
// classNameTwoçš„å­˜åœ¨ä¸å¦ï¼Œæ ¹æ®numberçš„å€¼è¿›è¡ŒåŠ¨æ€å±•ç¤º
import "./styles.css";
import clsx from "clsx";
const classNameOne = "redButton";
const classNameTwo = "blueBorder";
export default function App() {
  const number = 3;
  return (
    <div className="App">
      <button className={clsx(classNameOne, { [classNameTwo]: number > 5 })}>
        A sample button
      </button>
    </div>
  );
}

// => className='foo bar baz quux'
<div
  className={clsx("foo", { bar: true, duck: false }, "baz", { quux: true })}
/>;

const menuStyle = clsx({
  [classes.root]: true, //always applies
  [classes.menuOpen]: open, //only when open === true
});
```

#### å¤šæ å¸ƒå±€æ‹–æ‹½

[vue å®ç°å¤šæ å¸ƒå±€æ‹–æ‹½ï¼ˆæ”¹å˜ç›’å­çš„å®½åº¦ï¼‰\_vue æ‹–æ‹½æ”¹å˜ç›’å­å¤§å°-CSDN åšå®¢](https://blog.csdn.net/Little_Fishs/article/details/120150460)

#### ä¸»é¢˜åˆ‡æ¢å·¥ç¨‹åŒ–æ–¹æ¡ˆ

- https://juejin.cn/post/7414732430160183296

##### css å˜é‡æ–¹æ¡ˆ

- æŒ‰æ¢¯åº¦å±‚æï¼Œå®šä¹‰ä¸€ç³»åˆ— css é¢œè‰²å˜é‡

  - tailwindcss é¢„è®¾é¢œè‰²å€¼

- å°†æ¢¯åº¦ css å˜é‡ä½œä¸ºé¢œè‰²å€¼ä½¿ç”¨

  - `background-color: theme('colors.gray.500');`

- åœ¨ä¸šåŠ¡ä»£ç ä¸­åˆ©ç”¨ css å˜é‡æ¥è®¾ç½®é¢œè‰²

  ```css
  .app {
    background-color: var(--bg-color);
    color: var(--text-color);
  }
  ```

- æ·»åŠ åˆ‡æ¢ä¸»é¢˜çš„åŠŸèƒ½ï¼šç‚¹å‡»åˆ‡æ¢æ—¶æ›´æ¢æ ¹å…ƒç´ ç±»å æˆ– css å˜é‡çš„å€¼

### Vercel-ç½‘ç«™æ‰˜ç®¡

> å°†ç½‘ç«™æ‰˜ç®¡åˆ° vercelï¼Œè€Œä¸ç”¨è´­ä¹°æœåŠ¡å™¨

- [å®˜ç½‘ï¼Œæ³¨å†Œè´¦å·](https://vercel.com/new)

- å¯¼å…¥ä»£ç ä»“åº“ æˆ– æœ¬åœ°æ“ä½œ

- æœ¬åœ°

  - å…¨å±€å®‰è£… vercel `npm i -g vercel`

  - åœ¨æœ¬åœ°é¡¹ç›®çš„æ ¹ç›®å½• æ–°å»º`vercel.json`

    ![image-20230412113726723](images/å…¶ä»–æ¦‚å¿µ/image-20230412113726723.png)

    ```json
    {
      "rewrites": [{ "source": "/api/(.*)" }]
    }
    ```

  - æ ¹ç›®å½•æ–°å»º api æ–‡ä»¶å¤¹/index.js

    ![image-20230412113822967](images/å…¶ä»–æ¦‚å¿µ/image-20230412113822967.png)

  - å‘½ä»¤è¡Œç™»é™† vercel `vercel login` è‡ªåŠ¨è·³è½¬åˆ°ç½‘é¡µè¿›è¡Œç™»é™†ï¼ŒæˆåŠŸç¤ºä¾‹ï¼š

    ![image-20230412114024789](images/å…¶ä»–æ¦‚å¿µ/image-20230412114024789.png)

  - æœ¬åœ°å‘½ä»¤è¡Œç»§ç»­è¾“å…¥ `vercel` è¿›è¡Œæ¨é€ï¼Œè¿›è¡Œé…ç½®ï¼Œè‡ªåŠ¨ä¸Šä¼ æˆåŠŸ

  - åç»­ä¿®æ”¹åï¼Œåªéœ€è¾“å…¥ vercel ä¼šè‡ªåŠ¨æ¨é€

  - æ›´å¤šé…ç½®...

### å‰ç«¯å®‰å…¨

- [å¦‚ä½•å®‰å…¨ä¼ è¾“å­˜å‚¨ç”¨æˆ·å¯†ç ï¼Ÿ](https://www.cnblogs.com/jay-huaxiao/p/14224777.html#:~:text=æ€»ç»“ 1 å› æ­¤ï¼Œä¸€èˆ¬ä½¿ç”¨ https åè®® %2B éå¯¹ç§°åŠ å¯†ç®—æ³•ï¼ˆå¦‚ RSAï¼‰æ¥ä¼ è¾“ç”¨æˆ·å¯†ç ï¼Œä¸ºäº†æ›´åŠ å®‰å…¨ï¼Œå¯ä»¥åœ¨å‰ç«¯æ„é€ ä¸€ä¸‹éšæœºå› å­å“¦ã€‚ 2,ä½¿ç”¨ BCrypt %2B ç›å­˜å‚¨ç”¨æˆ·å¯†ç ã€‚ 3 åœ¨æ„ŸçŸ¥åˆ°æš´åŠ›ç ´è§£å±å®³çš„æ—¶å€™ï¼Œ ã€Œå¼€å¯çŸ­ä¿¡éªŒè¯ã€å›¾å½¢éªŒè¯ç ã€è´¦å·æš‚æ—¶é”å®šã€ ç­‰é˜²å¾¡æœºåˆ¶æ¥æŠµå¾¡æš´åŠ›ç ´è§£ã€‚)
- JavaScript åº“**ã€Œjsencryptã€**

### å‰ç«¯å¯è§‚æµ‹æ€§

> å‰ç«¯å¯è§‚æµ‹æ€§æ˜¯ä¸€å¥—ç§‘å­¦å®Œæ•´çš„æ€§èƒ½æ£€æµ‹ã€åˆ†æã€ä¼˜åŒ–ä½“ç³»ã€‚åŒ…å«ï¼šé¡µé¢æŒ‡æ ‡ã€ç½‘ç»œä¼ è¾“ã€æœåŠ¡å¯é æ€§ã€ç”¨æˆ·ä½“éªŒã€‚
>
> - https://www.bilibili.com/video/BV19a411A72Y/?spm_id_from=333.337.search-card.all.click&vd_source=49059bedc59884104ea6ef0a6e552378
> - [Clarity (microsoft.com)](https://clarity.microsoft.com/)
> - [ç™¾åº¦ç»Ÿè®¡â€”â€”ä¸€ç«™å¼æ™ºèƒ½æ•°æ®åˆ†æä¸åº”ç”¨å¹³å° (baidu.com)](https://tongji.baidu.com/web5/10000607949/welcome/login)

- æ„å»ºå‰ç«¯å¯è§‚æµ‹æ€§çš„åŸºç¡€æ¡ä»¶

  - åœ¨æµè§ˆå™¨æœ‰ä¸€å¥— æ”¶é›†å‘é€æŒ‡æ ‡çš„é€»è¾‘

  - æœåŠ¡å™¨å¯¹æŒ‡æ ‡è¿›è¡Œå­˜å‚¨å’Œå¤„ç† ÃŸ

  - å¯¹æŒ‡æ ‡è¿›è¡Œå¯è§†åŒ–å±•ç¤º
    - [timeline](https://ilkeryilmaz.github.io/timelinejs/)æ—¶é—´è½´ã€
      - three.jsã€D3.jsã€Echartsã€[scichart](https://www.scichart.com/examples/javascript-chart/)ã€[chart.js](https://www.chartjs.org/docs/latest/)ã€

- å€ŸåŠ©ç¬¬ä¸‰æ–¹äº§å“
  - è§‚æµ‹äº‘
  - å¬äº‘
  - å‹ç›Ÿ+

![image-20230327173427967](images/å…¶ä»–æ¦‚å¿µ/image-20230327173427967.png)

![img](images/å…¶ä»–æ¦‚å¿µ/20230327173518695.png)

![img](images/å…¶ä»–æ¦‚å¿µ/20230327173533472.png)

-

#### å¼‚å¸¸æ•è·

- ç›‘å¬å…¨å±€æœªæ•è·çš„é”™è¯¯`ç›‘å¬ windowçš„ erroräº‹ä»¶`

  ```js
  window.addEventListener("error",function(event){
    // eventé”™è¯¯äº‹ä»¶å¯¹è±¡
    event.message // æŠ¥é”™ä¿¡æ¯
    event.filename // æŠ¥é”™çš„æ–‡ä»¶
    event.lineno   event.columnNo // æŠ¥é”™çš„è¡Œåˆ—
    event.error.stack // æŠ¥é”™çš„å †æ ˆä¿¡æ¯
  
    let log = {}
  })
  ```









## ç»„ä»¶åº“å¼€å‘

- BEMï¼ˆblock element modifierï¼‰è§„èŒƒ

  ```typescript
  // block-ä»£ç å—    element-å…ƒç´      modifier-è£…é¥°    state-çŠ¶æ€
  // z-button  z-button_element z-button_element--disable  is-disable is-enabeld è¯¸å¦‚æ­¤ç±»çš„å‘½å
  
  // ä½†æ˜¯ä¸ºäº†ä¾¿ä¹¦å†™ï¼Œå¯å°è£…å‡½æ•°æ“ä½œ   å®ç°  :clss=[bem.b()]   =>  z-button
  
  function _bem(prefixName:string,blockSuffix:string,element:string,modifier:string){
      if(blockSuffix) prefixName+=`-${blockSuffix}`
      if(element) prefixName+=`__${element}`
      if(modifier) prefixName+=`--${modifier}`
      return prefixName
  }
  
  function createBEM (prefixName){
      const b = (blockSuffix:string = '') => _bem(prefixName,blockSuffix,'','')
      // element æ— å€¼æ—¶å–ç©ºï¼Œè€Œä¸åº”è¿”å›ä¸€ä¸ªblockï¼Œç”±äºä¸åç»­æ§åˆ¶æ ·å¼
      const e = (element:string = '') => element ? _bem(prefixName,'',element,'') : ''
      const m = (modifier:string = '') => modifier ? _bem(prefixName,'','',modifier) : ''
     	const be = (blockSuffix:string,element:string) => blockSuffix && element ? _bem(prefixName,blockSuffix,element,'') : ''
      const bm = (blockSuffix:string,modifier:string) => blockSuffix && modifier ? _bem(prefixName,blockSuffix,'',modifier) : ''
      const em = (element:string,modifier:string) => element && modifier ? _bem(prefixName,'',element,modifier) : ''
      const bem = (blockSuffix:string,element:string,modifier:string) =>  blockSuffix && element && modifier ? _bem(prefixName,blockSuffix,element,modifier) : ''
  
      const is = (name:string,state:any) => state ? `is-${name}` : ''
  
      return { b,e,m,be,bm,em,bem,is }
  }
  
  export function cerateNamespace(name:string)=>{
      const prefixName = `z-${name}`;
      return createBM(prefixName);
  }
  
  // æµ‹è¯• , jsç”Ÿæˆç±»å
  const bem = cerateNamespace('icon')
  bem.b()   // è¾“å‡ºï¼š z-icon
  bem.b('box')   // è¾“å‡ºï¼š z-icon-box
  bem.e('ele')   // è¾“å‡ºï¼š z-icon__ele
  bem.is('checked',true)   // è¾“å‡ºï¼š is-checked
  ```

## å•å…ƒæµ‹è¯•

> [æ¢ç´¢å‰ç«¯å•å…ƒæµ‹è¯•ä¹‹è·¯ ä»å…¥é—¨åˆ°ç²¾é€š Vitest ](https://blog.csdn.net/qq_41867608/article/details/136376417)
>
> [ã€Œæ•æ·æ¶æ„ã€æ ¸å¿ƒå®è·µï¼šæµ‹è¯•é©±åŠ¨å¼€å‘(TDD)ç®€ä»‹ - çŸ¥ä¹ (zhihu.com)](https://zhuanlan.zhihu.com/p/404832754)
>
> - ä¼˜åŠ¿ï¼šåŠæ—¶å‘ç° bugã€æ”¹å–„ä»£ç è´¨é‡ã€check ä»–äººä»£ç ã€æ´»æ–‡æ¡£
> - æœ€ä½³å†™æµ‹è¯•æ—¶æœºï¼šé€šè¿‡å•æµ‹æ›¿ä»£æ‰‹åŠ¨éªŒè¯ æˆ– å…ˆå†™æµ‹è¯•å†å®ç° TDD æ•æ·å¼€å‘ã€‚

```js
// å®‰è£… vitest ä¾èµ–  æ³¨ï¼šVitest 1.0 éœ€è¦ Vite >=v5.0.0 å’Œ Node >=v18.0.0
pnpm add -D vitest


```

## å‰ç«¯æ€§èƒ½ä¼˜åŒ–

#### æ€§èƒ½æŒ‡æ ‡

> - [å‰ç«¯æ€§èƒ½ä¼˜åŒ– â€”â€” é¡µé¢æ€§èƒ½æŒ‡æ ‡åŠå·¥å…·-CSDN åšå®¢](https://blog.csdn.net/m0_60166861/article/details/134331310)
> - [ã€ä¸€ã€‘å‰ç«¯æ€§èƒ½ç›‘æ§ä¹‹è¯·æ±‚è€—æ—¶ç»Ÿè®¡ - æ˜é‡‘ (juejin.cn)](https://juejin.cn/post/7218121928799764535)
> - [å¦‚ä½•è®¡ç®—æµè§ˆå™¨é¡µé¢çš„å¸§æ•° FPSï¼Ÿ - çŸ¥ä¹ (zhihu.com)](https://zhuanlan.zhihu.com/p/590686870)

##### æ‰“åŒ…è§†å›¾åˆ†æ

> vue3 ä¸­ rollup-plugin-visualizer
>
> [vite3+vue3 é¡¹ç›®æ‰“åŒ…ä¼˜åŒ–å®æˆ˜ä¹‹-è§†å›¾åˆ†æï¼ˆrollup-plugin-visualizerï¼‰ã€CDN å¼•å…¥ã€ä¾èµ–åˆ†åŒ…ã€gzip å‹ç¼©ã€history404 é—®é¢˜-CSDN åšå®¢](https://blog.csdn.net/g18204746769/article/details/127431733)

##### Lighthouse å‰ç«¯æ€§èƒ½åˆ†æ

- [lighthouse å·¥å…·](https://blog.csdn.net/m0_43550804/article/details/129756073#:~:text=Lighthouseæ˜¯ä¸€ä¸ªå¼€æºçš„è‡ªåŠ¨åŒ–å·¥å…·ï¼Œç”¨äºå¸®åŠ©æ”¹è¿›ç½‘ç»œåº”ç”¨çš„è´¨é‡ã€‚ å¯å°†å…¶ä½œä¸ºä¸€ä¸ª,Chrome æ‰©å±•ç¨‹åºè¿è¡Œï¼Œæˆ–ä»å‘½ä»¤è¡Œè¿è¡Œã€‚ Lighthouse åˆ†æ web åº”ç”¨ç¨‹åºå’Œ web é¡µé¢ï¼Œæ”¶é›†å…³äºå¼€å‘äººå‘˜æœ€ä½³å®è·µçš„ç°ä»£æ€§èƒ½æŒ‡æ ‡å’Œè§è§£ï¼Œè®©å¼€å‘äººå‘˜æ ¹æ®ç”Ÿæˆçš„è¯„ä¼°é¡µé¢ï¼Œæ¥è¿›è¡Œç½‘ç«™ä¼˜åŒ–å’Œå®Œå–„ï¼Œæé«˜ç”¨æˆ·ä½“éªŒã€‚)

#### é¡¹ç›®ä¼˜åŒ–

##### ä½¿ç”¨ä¸‰æ–¹ CDNã€ä¾èµ–åˆ†åŒ…ã€

> [vite3+vue3 é¡¹ç›®æ‰“åŒ…ä¼˜åŒ–å®æˆ˜ä¹‹-è§†å›¾åˆ†æï¼ˆrollup-plugin-visualizerï¼‰ã€CDN å¼•å…¥ã€ä¾èµ–åˆ†åŒ…ã€gzip å‹ç¼©ã€history404 é—®é¢˜-CSDN åšå®¢](https://blog.csdn.net/g18204746769/article/details/127431733)
>
> - å€ŸåŠ© CDN çš„ç‰¹æ€§ï¼Œå¯¹æ‰“åŒ…åçš„ä½“ç§¯è¿›è¡Œåˆ†æï¼Œå°†éƒ¨åˆ†è¾ƒå¤§çš„ç¬¬ä¸‰æ–¹åŒ…æ’é™¤åœ¨æ‰“åŒ…ä¹‹å¤–ï¼Œå¹¶ä½¿ç”¨ script æ–¹å¼å¼•å…¥åˆ°é¡¹ç›®ä¸­ä½¿ç”¨
>   - å¸¸è§å…¬å…± CDNï¼ˆæµ‹è¯•æ—¶é—´ 24.04.09 fabricjs5.3.0ï¼‰
>     - [å­—èŠ‚è·³åŠ¨é™æ€èµ„æºå…¬å…±åº“ (bytedance.com)](https://cdn.bytedance.com/)
>     - [jsDelivr](https://www.jsdelivr.com/) æ— å¯¹åº”ç‰ˆæœ¬èµ„æº
>     - [cdnjs](https://cdnjs.com/) 1.17s 834ms
>     - [Staticfile CDN](https://www.staticfile.net/) 260ms
>     - [UNPKG](https://unpkg.com/)
>     - [BootCDN - Bootstrap ä¸­æ–‡ç½‘å¼€æºé¡¹ç›®å…è´¹ CDN åŠ é€ŸæœåŠ¡](https://www.bootcdn.cn/)
>     - è‡ªæœ‰æœåŠ¡å™¨ 101ms 17ms
> - vite é…ç½®
>   - [MMF-FE/vite-plugin-cdn-import - Vite ä¸­æ–‡æ–‡æ¡£ (viterc.cn)](https://www.viterc.cn/en/vite-plugin-cdn-import.html)
>   - [vite-plugin-cdn-import-async - npm (npmjs.com)](https://www.npmjs.com/package/vite-plugin-cdn-import-async)
>   - æ³¨æ„ï¼š
>     - å®¹æ˜“ç”±äºé”™ç»¼å¤æ‚çš„ä¾èµ–å…³ç³»
>     - æˆ–è€…å¼‚æ­¥è®°è½½çš„é—®é¢˜ï¼Œå¯¼è‡´æ‰§è¡Œæ—¶æŠ¥é”™

```js
// vite-plugin-cdn-import
pnpm install vite-plugin-cdn-import --save-dev
// vite.config.js åŸºæœ¬ç”¨æ³•
import reactRefresh from '@vitejs/plugin-react-refresh'
import importToCDN from 'vite-plugin-cdn-import'

import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'
import { autoComplete, Plugin as importToCDN } from 'vite-plugin-cdn-import';

export default defineConfig({
  plugins: [vue(),
   importToCDN({
    prodUrl: 'https://unpkg.com/{name}@{version}/{path}',
    modules: [
      autoComplete('vue'),
      {
        name: 'element-plus',
        var: 'ElementPlus', //æ ¹æ®main.jsä¸­å®šä¹‰çš„æ¥
        version: '2.2.17',
        path: 'dist/index.full.js',
        css: 'dist/index.css'
      },
      {
        name: 'vue-demi',
        var: 'VueDemi', //æ ¹æ®main.jsä¸­å®šä¹‰çš„æ¥
        version: '0.13.11',
        path: 'lib/index.iife.js'
      },
      {
        name: '@element-plus/icons-vue',
        var: 'ElementPlusIconsVue', //æ ¹æ®main.jsä¸­å®šä¹‰çš„æ¥
        version: '2.0.9',
        path: 'dist/index.iife.min.js'
      },
    ],
  })
],
)}




// viteä¸­  ä½¿ç”¨ vite-plugin-cdn-import   æˆ–  vite-plugin-cdn-import-asyncï¼ˆæ€§èƒ½æ›´é«˜ï¼Ÿï¼Œå¯è®¾ç½® defer/async ï¼‰
pnpm install vite-plugin-cdn-import-async --save-dev

// vite.config.js åŸºæœ¬ç”¨æ³•
import cdnImport from 'vite-plugin-cdn-import-async'	// å¼•å…¥cdnImport

export default {
    plugins: [
        cdnImport({
            modules: [
                {
                    name: 'react',
                    var: 'React',
                    mode: 'async', // 'async' atrribute will be added to its <script> tag.
                    path: `https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.production.min.js`,
                },
                {
                    name: 'lottie-web',
                    var: 'lottie',
                    mode: 'defer', // 'defer' atrribute will be added to its <script> tag.
                    path: `https://cdn.jsdelivr.net/npm/lottie-web@5.10.0/build/player/lottie.min.js`,
                },
                {
                    name: 'axios',  // Module without 'mode' param will be loaded synchronously.
                    var: 'axios',
                    path: 'https://cdn.jsdelivr.net/npm/axios@1.2.1/dist/axios.min.js',
                }
            ],
        }),
    ],
}

```

##### å¼€å¯ gzip

> Nginx å¼€å¯ Gzip apach å¼€å¯ gzip å‰ç«¯è„šæ‰‹æ¶å¼€å¯ gzip cdn å¼€å¯ gzip
>
> [nginx ä¸­å¦‚ä½•è®¾ç½® gzipï¼ˆæ€»ç»“ï¼‰ - èŒƒä»ä¹‰ - åšå®¢å›­ (cnblogs.com)](https://www.cnblogs.com/Renyi-Fan/p/11047490.html)

#### http ç¼“å­˜

[å‰ç«¯ç¼“å­˜ï¼ˆæµè§ˆå™¨ç¼“å­˜å’Œ http ç¼“å­˜ï¼‰è¯¦è§£\_å‰ç«¯æµè§ˆå™¨ç¼“å­˜-CSDN åšå®¢](https://blog.csdn.net/hyupeng1006/article/details/126599764)

##### å¼ºåˆ¶ç¼“å­˜

> ç›´æ¥ä»å†…å­˜ä¸­è¯»å–ç›®æ ‡èµ„æºï¼Œæ— éœ€ä¸æœåŠ¡å™¨åšä»»ä½•é€šè®¯

- åŸºäº Cache-control å®ç°çš„å¼ºç¼“å­˜ï¼ˆä»£æ›¿ Expires çš„å¼ºç¼“å­˜å®ç°æ–¹æ³•ï¼‰

  - **max-age** å†³å®šå®¢æˆ·ç«¯èµ„æºè¢«ç¼“å­˜å¤šä¹…ã€‚
  - **s-maxage** å†³å®šä»£ç†æœåŠ¡å™¨ç¼“å­˜çš„æ—¶é•¿ã€‚
  - **no-cache ** è¡¨ç¤ºæ˜¯å¼ºåˆ¶è¿›è¡Œåå•†ç¼“å­˜ã€‚
  - **no-store** æ˜¯è¡¨ç¤ºç¦æ­¢ä»»ä½•ç¼“å­˜ç­–ç•¥ï¼Œä¸ no-cache äº’æ–¥
  - **public ** è¡¨ç¤ºèµ„æºå³å¯ä»¥è¢«æµè§ˆå™¨ç¼“å­˜ä¹Ÿå¯ä»¥è¢«ä»£ç†æœåŠ¡å™¨ç¼“å­˜ã€‚
  - **private** é»˜è®¤å€¼ï¼Œè¡¨ç¤ºèµ„æºåªèƒ½è¢«æµè§ˆå™¨ç¼“å­˜ï¼Œ

  ```js
  //å¾€å“åº”å¤´ä¸­å†™å…¥éœ€è¦ç¼“å­˜çš„æ—¶é—´,å•ä½ ç§’ s
  
  res.writeHead(200, {
    "Cache-Control": "max-age=10", // è¯¥èµ„æºç¬¬ä¸€æ¬¡è¿”å›åå¼€å§‹ï¼Œ10ç§’å†…è¢«å†æ¬¡è¯·æ±‚ï¼Œåˆ™ä»ç¼“å­˜ä¸­è¯»å–
    // Cache-control:max-age=10000,s-maxage=200000,public // å¤šä¸ªå€¼ä½¿ç”¨,å·åˆ†å‰²
  });
  ```

##### åå•†ç¼“å­˜

é€šè¿‡è¯·æ±‚ä¸­æºå¸¦æ–‡ä»¶ä¿®æ”¹æ—¶é—´ æˆ– æ–‡ä»¶æŒ‡çº¹ ä¸æœåŠ¡å™¨è¿›è¡Œæ¯”å¯¹ï¼Œåˆ¤æ–­æ˜¯å¦ä½¿ç”¨ç¼“å­˜æ–‡ä»¶

#### ç½‘é¡µåŠ è½½è¿‡ç¨‹

- web å‰ç«¯çš„å¼€å‘ä¸éƒ¨ç½²è¿‡ç¨‹

  - ç”¨æˆ·ä½¿ç”¨æµè§ˆå™¨ï¼Œå€ŸåŠ©ç½‘å€å‘æœåŠ¡å™¨è·å–ã€åŠ¨æ€çš„ã€å¢é‡å¼ã€‘çš„é™æ€èµ„æº
  - ![image-20211130230533113.png](images/å…¶ä»–æ¦‚å¿µ/image-20211130230533113.png)

- ç”¨æˆ·è¾“å…¥ url ï¼Œæµè§ˆå™¨è§£æåå‘é€åˆ° DNS æœåŠ¡å™¨ï¼ŒæŸ¥è¯¢ ip åœ°å€ã€DNS ç¼“å­˜ï¼Œé™ä½ dns æŸ¥è¯¢çš„æ—¶é—´ï¼Ÿã€‘

- å€ŸåŠ©åŸºç¡€ç½‘ç»œï¼Œä¼ è¾“åˆ°å¯¹åº”çš„æœåŠ¡å™¨ã€ä½¿ç”¨ CDN è¯·æ±‚é™æ€èµ„æºï¼Œè§£å†³ç½‘ç»œç¼“å­˜ã€çº¿è·¯é€‰æ‹©ç­‰é—®é¢˜ï¼Œä½†é»˜è®¤æºå¸¦çš„ cookie æ˜¯ä¸€ç§æµªè´¹ï¼Œä¸åŒçš„ cdn åŸŸåå¯ä»¥è§£å†³ï¼›ä½† cdn æ— æ³•ä½œä¸ºæ¥å£ã€‘

- æœåŠ¡å™¨æ¥æ”¶åˆ°è¯·æ±‚åï¼Œè¿›è¡Œè¯·æ±‚çš„åˆ†å‘å¤„ç† Contorller

  - Model å±‚ï¼Œè¿›è¡Œæ•°æ®äº¤äº’ï¼Œè¯»å–æ•°æ®åº“ï¼Œè·å–æ•°æ®
  - æœ€åå°†æ¸²æŸ“å¥½çš„é¡µé¢é€šè¿‡ Viewï¼Œè¿”ä¼šç»™ç½‘ç»œ--æµè§ˆå™¨

- æµè§ˆå™¨æ¥å—æ•°æ®ã€ å‡å°‘ http è¯·æ±‚çš„æ¬¡æ•°å’Œå¤§å°ï¼Ÿã€‘

  - rander è¿‡ç¨‹ï¼Œæµè§ˆå™¨å°†æœåŠ¡å™¨è¿”å›çš„æ•°æ®(html/css/js...)è¿›è¡Œæ¸²æŸ“ã€æœåŠ¡å™¨ç«¯æ¸²æŸ“ï¼Ÿã€‘

  - æµè§ˆå™¨ç”Ÿæˆ DOM å’Œ BOM æ ‘ï¼Œåœ¨è¿›è¡Œ css æ¸²æŸ“ï¼Œç„¶åå†å»æ‰§è¡Œ js ç›¸å…³çš„ä»£ç ã€æ¸²æŸ“è¿‡ç¨‹çš„ä¼˜åŒ–ï¼Ÿã€‘![image-20211130230829988](images/å…¶ä»–æ¦‚å¿µ/image-20211130230829988.png)

#### èµ„æºçš„åˆå¹¶ä¸å‹ç¼©

**ä½œç”¨ç‚¹ï¼šå€ŸåŠ©æ–‡ä»¶çš„åˆå¹¶å‡å°‘ http è¯·æ±‚æ¬¡æ•°ï¼›å€ŸåŠ©æ–‡ä»¶å‹ç¼©ï¼Œå‡å°‘è¯·æ±‚æ–‡ä»¶çš„å¤§å°**

##### html å‹ç¼©

- å‹ç¼©åœ¨æ–‡æœ¬æ–‡ä»¶ä¸­æœ‰æ„ä¹‰ï¼Œä½†åœ¨ HTML ä¸­ä¸æ˜¾ç¤ºçš„å­—ç¬¦ï¼ŒåŒ…æ‹¬ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢è¡Œç¬¦ç­‰ï¼Œè¿˜æœ‰ä¸€äº›å…¶ä»–æ„ä¹‰çš„å­—ç¬¦ï¼Œå¦‚ï¼šHTML æ³¨é‡Šä¹Ÿå¯ä»¥è¢«å‹ç¼©
- HTML å‹ç¼©çš„æ•ˆæœä¸æ˜¯å¾ˆæ˜æ˜¾ï¼Œä½†å¯¹äºå¤§é‡ç”¨æˆ·è®¿é—®çš„ç½‘é¡µæ¥è¯´ï¼Œæ¯ kb çš„æµé‡éƒ½ä¸å®¹å¿½è§†

##### html å‹ç¼©æ–¹å¼

- ä½¿ç”¨ç½‘ç«™åœ¨çº¿å‹ç¼©ï¼Œé€‚åˆåˆå­¦è€…ï¼ˆä½†ä¸€èˆ¬ä¸ç”¨ï¼Œä½¿ç”¨ webpack...ï¼‰
- node.js æä¾›äº† `html-minifier`å·¥å…·ï¼ˆå¯ä»¥è¿›è¡Œå¾ˆå¤šçš„é…ç½®ï¼Œå…·æœ‰å¯æ‰©å±•æ€§ï¼‰
- åç«¯æ¨¡æ¿å¼•æ“æ¸²æŸ“å‹ç¼©ï¼ˆä¼šå¢åŠ æœåŠ¡ç«¯çš„è®¡ç®—é‡ï¼‰

##### css å‹ç¼©

- ä½¿ç”¨åœ¨çº¿ç½‘ç«™è¿›è¡Œå‹ç¼©
- ä½¿ç”¨`html-minifier`åº“å¯¹ html ä¸­çš„ css è¿›è¡Œå‹ç¼©
- ä½¿ç”¨`clean-css`åº“å¯¹ css è¿›è¡Œå‹ç¼©

##### js å‹ç¼©ä¸æ··ä¹±

- ä½œç”¨ï¼šæ— æ•ˆå­—ç¬¦çš„åˆ é™¤ã€å‰”é™¤æ³¨é‡Šã€ä»£ç è¯­ä¹‰çš„ç¼©å‡å’Œä¼˜åŒ–ã€ä»£ç ä¿æŠ¤(é™ä½å¯è¯»æ€§)
- æ–¹æ³•ï¼š
  - ä½¿ç”¨ç½‘ç«™åœ¨çº¿å‹ç¼©
  - ä½¿ç”¨`html-minifier`é…ç½®ï¼Œå¯¹ js è¿›è¡Œå‹ç¼©
  - ä½¿ç”¨`uglifyjs2`å¯¹ js è¿›è¡Œå‹ç¼©ã€ã€‘







##### æ–‡ä»¶åˆå¹¶

- ä¸åˆå¹¶å­˜åœ¨çš„é—®é¢˜

  - æ–‡ä»¶ä¸æ–‡ä»¶ä¹‹é—´æœ‰æ’å…¥çš„ä¸Šè¡Œè¯·æ±‚ï¼Œå¢åŠ äº† N-1 ä¸ªç½‘ç»œå»¶è¿Ÿ

  - å—ä¸¢åŒ…å½±å“æ›´ä¸ºä¸¥é‡

  - ç»è¿‡ä»£ç†æœåŠ¡å™¨æ—¶å¯èƒ½ä¼šè¢«æ–­å¼€

  - ![image-20211201103045973](images/å…¶ä»–æ¦‚å¿µ/image-20211201103045973.png)

- åˆå¹¶åçš„é—®é¢˜

  - é¦–å±æ¸²æŸ“é—®é¢˜ï¼Œåˆå¹¶åæ–‡ä»¶å˜å¤§ï¼Œé¦–å±æ¸²æŸ“å¯èƒ½å‡æ…¢ï¼Œéœ€è¦é€‚å½“åˆ†å¼€
  - ç¼“å­˜å¤±æ•ˆé—®é¢˜ï¼Œä»»ä¸€æ–‡ä»¶çš„æ”¹åŠ¨ï¼Œä¼šå¯¼è‡´æ–‡ä»¶ç¼“å­˜å¤§é¢ç§¯å¤±æ•ˆçš„é—®é¢˜

- æ–‡ä»¶åˆå¹¶çš„å»ºè®®

  - å…¬å…±åº“åˆå¹¶ï¼Œå¯¹é•¿æœŸä¸ç»å¸¸æ”¹åŠ¨çš„å†…åˆå¹¶
  - ä¸åŒé¡µé¢çš„åˆå¹¶ï¼Œå¯¹äºå•é¡µåº”ç”¨ï¼ŒåªåŠ è½½å½“å‰é¡µé¢ï¼Œåˆ†åˆ«æ‰“åŒ…ã€‚
  - è§æœºè¡Œäº‹ï¼Œéšæœºåº”å˜ã€‚

- æ–‡ä»¶åˆå¹¶æ–¹æ³•

  - ä½¿ç”¨åœ¨çº¿ç½‘ç«™è¿›è¡Œ
  - ä½¿ç”¨ node.js å®ç°æ–‡ä»¶åˆå¹¶ï¼Œå¤šç§å¤šæ ·çš„åº“ï¼Œè‡ªè¡ŒæŒ‘é€‰





#### æ“ä½œæµç¨‹

##### åœ¨çº¿å‹ç¼©å·¥å…·

- æœ‰ä¸€å®šçš„é™åˆ¶ï¼Œå¯èƒ½ä¸æ”¯æŒéƒ¨åˆ†æ–‡ä»¶æ ¼å¼çš„å‹ç¼©
- åˆ†åˆ«æ‰‹åŠ¨å¯¹åŸç”Ÿä»£ç è¿›è¡Œå‹ç¼©
- åœ¨ js å‹ç¼©è¿‡ç¨‹ä¸­ï¼Œéœ€è¦æ‰‹åŠ¨æ ¹æ®ä¾èµ–å…³ç³»å‹ç¼©åå†åˆå¹¶
- ![image-20211201105304024](images/å…¶ä»–æ¦‚å¿µ/image-20211201105304024.png)

##### æ„å»ºå·¥å…·çš„ä¼˜ç‚¹

- å¯¹äºå¤§é‡çš„æ–‡ä»¶å¯ä»¥è¿›è¡Œé«˜æ•ˆå¿«é€Ÿçš„æ„å»º
- å…·æœ‰è‰¯å¥½çš„å¯æ‰©å±•æ€§
- å¯æ ¹æ®é…ç½®è¿›è¡Œå®šåˆ¶åŒ–çš„è®¾ç½®

##### webpack æ„å»ºå·¥å…·(ä½¿ç”¨å†å­¦ä¹ )

##### fis3 æ„å»ºå·¥å…·(ä½¿ç”¨å†å­¦ä¹ )

- æµç¨‹ï¼š
  - å•æ–‡ä»¶ç¼–è¯‘è¿‡ç¨‹ï¼Œå½¢æˆå®Œæ•´çš„ç»“æ„
  - æ‰“åŒ…ï¼Œä¾æ®æºæ–‡ä»¶çš„å†…å®¹ï¼Œè¿›è¡Œå‹ç¼©å’Œæ··ä¹±

![image-20211201105540261](images/å…¶ä»–æ¦‚å¿µ/image-20211201105540261.png)

#### å›¾ç‰‡ç›¸å…³ä¼˜åŒ–

**ä½¿ç”¨å‚è€ƒï¼šæ–‡ä»¶å¤§å°ã€è‰²å½©çš„ä¸°å¯Œåº¦ æ ¹æ®ä¸åŒåœºæ™¯è¿›è¡Œé€‰æ‹©**

##### ç±»å‹åˆ†ç±»

###### JPG å›¾ç‰‡- æœ‰æŸå‹ç¼©

- æƒ…æ™¯ï¼šå¤§éƒ¨åˆ†**ä¸éœ€è¦é€æ˜å›¾ç‰‡**çš„ä¸šåŠ¡åœºæ™¯
- åŸå§‹çš„æ•°æ®ä¸å®é™… jpg å‹ç¼©åçš„æ•°æ®æ˜¯ä¸åŒçš„
- ä½†å¤§å¤šæ•° jpg å‹ç¼©å¹¶ä¸å½±å“è‚‰çœ¼è§‚å¯Ÿ
- å¯èƒ½ä¸æ”¯æŒé€æ˜ï¼Œä½†å®é™…ä½¿ç”¨å¤§éƒ½å¯ä»¥é€æ˜

###### png8/png24/png32

- æƒ…æ™¯ï¼šå¤§éƒ¨åˆ†éœ€è¦**é€æ˜å›¾ç‰‡**çš„ä¸šåŠ¡åœºæ™¯
- png8ï¼š256 è‰²+æ”¯æŒé€æ˜ï¼Œ
  - å†…éƒ¨å…¶å®æ˜¯ä¸€ä¸ªé¢œè‰²çš„ç´¢å¼•è¡¨ï¼Œæ¯ä¸ªé¢œè‰²å°±æ˜¯ 2^8 çš„ç´¢å¼•å€¼ï¼Œå› æ­¤ä¼šå°å¾ˆå¤š
  - é€‚ç”¨äºé¢œè‰²å˜åŒ–ä¸ç‰¹åˆ«ä¸°å¯Œçš„å›¾ç‰‡
  - ç¼ºç‚¹ï¼šæ”¯æŒçš„é¢œè‰²æ¯”è¾ƒå°‘ï¼Œä¸é€‚åˆé¢œè‰²ä¸°å¯Œä¸”ç›¸è¿‘çš„å›¾ç‰‡
- png24ï¼š2^24 è‰²+ä¸æ”¯æŒé€æ˜
  - æ¯ä¸€ä¸ªç´¢å¼•å€¼æ˜¯ png8 çš„ä¸‰å€
- png32ï¼š2^24 è‰²+æ”¯æŒé€æ˜
  - ç›¸æ¯”äº png24ï¼Œå¢åŠ äº† 8 ä½ï¼Œç”¨äºæ”¯æŒé€æ˜

###### webp å‹ç¼©ç¨‹åº¦æ›´å¥½ï¼Œå† ios å’Œ webview æœ‰å…¼å®¹æ€§é—®é¢˜

- å‹ç¼©ç¨‹åº¦æ›´å¥½ï¼Œå»ºè®®å®‰å“å…¨éƒ¨ä½¿ç”¨

###### svg çŸ¢é‡å›¾ï¼Œä»£ç å†…åµŒï¼Œç›¸å¯¹è¾ƒå°ï¼Œå›¾ç‰‡æ ·å¼ç›¸å¯¹ç®€å•çš„åœºæ™¯

- æƒ…æ™¯ï¼šå›¾ç‰‡æ ·å¼ç›¸å¯¹ç®€å•çš„ä¸šåŠ¡åœºæ™¯
- ä¾‹å¦‚ icon åº“ï¼Œæˆ–è€…å…¶ä»–åº“....

###### gif æ”¯æŒåŠ¨ç”»

##### å›¾ç‰‡å‹ç¼©

> æœ¬è´¨ï¼šé’ˆå¯¹å›¾ç‰‡çœŸå®æƒ…å†µï¼Œèˆå¼ƒä¸€äº›ç›¸å¯¹æ— å…³ç´§è¦çš„è‰²å½©ä¿¡æ¯
>
> - css é›ªç¢§å›¾ï¼šä¸€äº›å›¾ç‰‡åˆå¹¶åˆ°ä¸€å¼ å›¾ç‰‡ï¼Œå‡å°‘ç½‘ç«™çš„ HTTP è¯·æ±‚æ•°é‡ï¼ˆä¸å¸¸ç”¨ï¼‰
>   - [Sprite Cow é›ªç¢§å›¾åˆ¶ä½œ - Generate CSS for sprite sheets](http://www.spritecow.com/)

###### Image inline

- å°†å›¾ç‰‡çš„å†…å®¹å†…åµŒåˆ° html ä¸­ï¼Œå‡å°‘ç½‘ç«™çš„ http è¯·æ±‚æ•°é‡
- é€‚åˆå¤§å°è¾ƒå°çš„å›¾ç‰‡ï¼Œå»ºè®® 8kb ä»¥ä¸‹åš inline image ä½¿ç”¨
- ç‰¹ç‚¹ï¼šå¯¼è‡´é¡µé¢æ–‡ä»¶å˜å¤§ï¼Œä½†å‡å°‘äº†ä¸€æ¬¡ http è¯·æ±‚
- ![image-20211213162118143](images/å…¶ä»–æ¦‚å¿µ/image-20211213162118143.png)

###### svg çŸ¢é‡å›¾

- ä½¿ç”¨ svg æ ‡ç­¾è¿›è¡ŒçŸ¢é‡å›¾çš„ç»˜åˆ¶
- ä½¿ç”¨ iconfont è§£å†³ icon é—®é¢˜
- ä¼˜ç‚¹ï¼šé€Ÿåº¦å’Œå¤§å°éƒ½ä¼šæœ‰å¾ˆå¥½çš„ä¼˜åŒ–
- å­¦ä¹ ï¼šw3c

###### webp

- ä¼˜åŠ¿ï¼šå…·æœ‰æ›´ä¼˜çš„å›¾åƒæ•°æ®å‹ç¼©ç®—æ³•ï¼Œèƒ½å¸¦æ¥æ›´å°çš„ä½“ç§¯ï¼Œæ‹¥æœ‰æ— å·®åˆ«çš„å›¾åƒè´¨é‡
- å…·å¤‡æ— æŸå’Œæœ‰æŸçš„å‹ç¼©æ¨¡å¼ã€Alpha é€æ˜ã€åŠ¨ç”»ç‰¹æ€§
- å† PNG å’Œ JPEG ä¸Šçš„è½¬å“ˆæ•ˆæœéƒ½éå¸¸ä¼˜ç§€ã€ç¨³å®šå’Œç»Ÿä¸€

##### è½¬æ¢æ–¹æ³•

###### æ ¼å¼è½¬æ¢

- [TinyPNG â€“ Compress WebP, PNG and JPEG images intelligently](https://tinypng.com/)
- [æ™ºå›¾*å›¾ç‰‡å‹ç¼©åœ¨çº¿å·¥å…·*åœ¨çº¿åˆ¶ä½œ webp (isux.us)](https://zhitu.isux.us/)
- [SVG æ•™ç¨‹ (w3school.com.cn)](https://www.w3school.com.cn/svg/index.asp)
- å›¾ç‰‡æ ¼å¼çš„é™çº§ï¼šå…¼å®¹æ€§æœåŠ¡ï¼Œå¦‚æœä¸æ”¯æŒæ›´å¥½çš„ webp æ ¼å¼ï¼Œè‡ªåŠ¨è½¬åŒ–ä¸º jpg æ ¼å¼(æ·˜å®ç½‘)
- è½¬æ¢æ–¹æ³•
  - æ‰‹åŠ¨æ›´æ”¹è½¬æ¢
  - ä½¿ç”¨ webpack æˆ–è€… fis3 ç­‰å…¶ä»–è‡ªåŠ¨åŒ–å·¥å…·ï¼Œè¿›è¡Œæ’ä»¶é…ç½®è¿˜èƒ½æ§åˆ¶å‹ç¼©ç‡
  - åç«¯æœåŠ¡è‡ªåŠ¨è½¬æ¢

![image-20211213204333298](images/å…¶ä»–æ¦‚å¿µ/image-20211213204333298.png)

#### css å’Œ js çš„è£…è½½ä¸æ‰§è¡Œ

- å­¦ä¹ ç›®æ ‡ï¼š
  1. ç†è§£æµè§ˆå™¨ç«¯ htmlã€cssã€js çš„åŠ è½½è¿‡ç¨‹
  2. ç»“åˆ chrome çš„èƒ½åŠ›å­¦ä¹ æŒæ¡åŠ è½½è¿‡ç¨‹ä¸­çš„ä¼˜åŒ–ç‚¹
- æ¸²æŸ“çš„è¿‡ç¨‹
  1. æ‹¿åˆ° html æ–‡ä»¶åæ¸²æŸ“ä¸º DOM æ ‘
     - HTML æ¸²æŸ“ç‰¹ç‚¹
     - è¯æ³•åˆ†æï¼Œç”±ä¸Šè‡³ä¸‹é¡ºåºæ‰§è¡Œç”Ÿæˆ DOMï¼Œ
     - å¤šç§èµ„æºçš„åŠ è½½æ˜¯å¹¶å‘è¿›è¡ŒåŠ è½½çš„(å—æµè§ˆå™¨å¯¹å•ä¸ªåŸŸåå¹¶å‘è¯·æ±‚é™åˆ¶)ï¼Œå› æ­¤ä¸€ä¸ªç½‘ç«™å¸¸ä½¿ç”¨å¤šä¸ª cdn æœåŠ¡
     - æ˜¯å¦é˜»å¡ï¼šcss åŠ è½½é˜»å¡ js åŠ è½½ï¼Ÿjs åŠ è½½é˜»å¡ js æ‰§è¡Œï¼Ÿ
       - css åœ¨ head ä¸­é˜»å¡é¡µé¢çš„æ¸²æŸ“ï¼Œå½“ css åŠ è½½å®Œå†æ¸²æŸ“ html(æ¨è)
       - css é˜»å¡ js çš„æ‰§è¡Œï¼Œå› ä¸º js çš„æ‰§è¡Œå¯èƒ½æ“ä½œ css çš„å†…å®¹
       - css ä¸é˜»å¡å¤–éƒ¨è„šæœ¬çš„åŠ è½½ï¼Œå¹¶å‘åŠ è½½
       - ç›´æ¥å¼•å…¥çš„ js é˜»å¡é¡µé¢çš„æ¸²æŸ“ï¼Œå­˜åœ¨ js æ“ä½œ dom æ—¶ï¼Œå½±å“ dom åŠ è½½
       - js ä¸é˜»å¡èµ„æºçš„åŠ è½½ï¼ˆæœ‰ä¸€ä¸ªé¢„å…ˆæ‰«æå™¨ï¼Œä¸æ‰§è¡Œå…ˆåŠ è½½ï¼‰
       - js é¡ºåºæ‰§è¡Œï¼Œé˜»å¡åç»­ js é€»è¾‘çš„æ‰§è¡Œ
     - ä¾èµ–å…³ç³»ï¼šcss èµ„æºåŠ è½½è¿‡æ…¢æ—¶ï¼Œå‡ºç°å±é—ªé—®é¢˜(ç­‰å®Œå…¨æ¸²æŸ“å®Œåå†æ˜¾ç¤º)
     - å¼•å…¥æ–¹å¼ï¼š
       - cssï¼šlink å’Œ @import
       - jsï¼šscript å’Œ è·¯ç”±åŠ¨æ€å¼•å…¥ å’Œ å’Œ
  2. å†æ ¹æ® css æ ·å¼ç”Ÿæˆ CSSOM æ ‘
  3. å°†ä¸¤è€…åˆå¹¶æ¸²æŸ“ä¸ºé¡µé¢

![image-20211213211431367](images/å…¶ä»–æ¦‚å¿µ/image-20211213211431367-16610832539038.png)

#### CSS

- ä½¿ç”¨`transfrom`,æ‰‹åŠ¨å¼€å¯ 3d æ¨¡å¼ï¼Œå¯ä»¥ä»£å¼€ç³»ç»Ÿæ¸²æŸ“
  - å¯¹æ¯”`position`å®šä½çš„ç§»åŠ¨ï¼Œä¼šå¥½å¾ˆå¤šï¼ˆé€šè¿‡æµè§ˆå™¨â€œæ€§èƒ½ performanceâ€ ç›‘æµ‹æ•°æ®ï¼‰
  - https://www.cnblogs.com/rmticocean/articles/16918354.html

#### JS

- å°½å¯èƒ½é¿å…æ±¡æŸ“å…¨å±€å˜é‡ï¼Œå…¨å±€å£°æ˜çš„å˜é‡ä¸ä¼šè¢«åƒåœ¾å›æ”¶æœºåˆ¶å›æ”¶
- å±€éƒ¨å˜é‡åœ¨ä»£ç è°ƒç”¨ç»“æŸä¹‹åï¼Œå°±ä¼šé‡Šæ”¾å¯¹åº”çš„å†…å­˜ç©ºé—´ï¼Œæé«˜ä»£ç æ€§èƒ½

#### æ€»ç»“-ä¼˜åŒ–ç‚¹

1. å‡å°‘ HTTP è¯·æ±‚æ•°é‡

   - å¤šåŸŸå ä¸è¶…è¿‡ 6 ä¸ªï¼Œæœ‰çš„ä¼šæ ¹æ®åŸŸåè¿›è¡Œé™åˆ¶ï¼ŒåŒä¸€åŸŸååŒä¸€æ—¶åˆ»ä¼šé™åˆ¶è¯·æ±‚æ•°é‡
   - åˆå¹¶ä»£ç ï¼Œä½¿ç”¨é›ªç¢§å›¾ã€ç²¾çµå›¾æˆ– canvasã€svg ç­‰æ–¹å¼å°†å›¾ç‰‡è½¬ä¸ºä»£ç 
   - ä½¿ç”¨æ›´åˆç†çš„ä»£ç é€»è¾‘ï¼Œé˜²æŠ–èŠ‚æµç­‰å‡å°‘è¯·æ±‚

2. å‹ç¼©è¯·æ±‚æ•°æ®çš„å¤§å°ï¼Œå‡å°‘æ¯æ¬¡è¯·æ±‚çš„ä»£ç é‡

   - ä¸€èˆ¬å€ŸåŠ©æ‰“åŒ…å·¥å…·ï¼Œå¯¹ä»£ç ã€å›¾ç‰‡è¿›è¡Œå‹ç¼©
   - ä»£ç é€»è¾‘ä¸­å»é™¤é‡å¤çš„ è„šæœ¬/ä»£ç  å¼•ç”¨

3. è¾ƒå°‘ cookie ä½“ç§¯ï¼Œä¼šåœ¨æ¯æ¬¡è¯·æ±‚ä¸­æºå¸¦ï¼Œå½±å“è¯·æ±‚çš„é€Ÿåº¦

4. å»¶è¿ŸåŠ è½½éå¿…è¦çš„å¼•ç”¨è„šæœ¬ - å½“å‰å¤ªæ…¢ï¼Œç å½“å‰

   - å‡æ‘Šç¬¬ä¸€æ¬¡åŠ è½½æ—¶çš„ä»»åŠ¡é‡ï¼Œæå‡ä½“éªŒ

5. é¢„åŠ è½½å¯èƒ½éœ€è¦çš„å†…å®¹ - å½“å‰å¤ªæ…¢ï¼Œç‰ºç‰²ä¸Šæ¬¡

   - åœ¨ä¸Šæ¬¡åŠ è½½ä¸­ æå‰åŠ è½½æœ¬æ¬¡éœ€è¦çš„å†…å®¹

6. å‡å°‘ DOM å…ƒç´ çš„å±‚çº§

7. å‡å°‘ css ä»£ç ä¸­ï¼Œæ ‡ç­¾åµŒå¥—çš„å±‚çº§

8. å‡å°‘ DOM çš„è®¿é—®æ¬¡æ•°ï¼Œè¾ƒå°‘ DOM çš„é‡æ„(å›æµ)ï¼Œå’Œä¸å¿…è¦çš„é‡ç»˜

9. ä½¿ç”¨ç‰¹åˆ«çš„å±æ€§ï¼Œopacityã€transformã€

   > è¿™äº›å±æ€§èƒ½å¤Ÿåœ¨ä¸åŒçš„å±‚ï¼Œè¿›è¡Œå•ç‹¬ç»˜åˆ¶ï¼Œä¸ä¼šå¯¼è‡´é¡µé¢é‡ç»˜
   >
   > é—´æ¥ä½¿ç”¨è®¾å¤‡ GPU ç¡¬ä»¶æ¸²æŸ“ï¼Œæå‡æ•ˆç‡

10. åˆç†åˆ©ç”¨ HTTP ç¼“å­˜ï¼Œæµè§ˆå™¨ç¼“å­˜ï¼Œåˆ©ç”¨é™æ€èµ„æº

    - æœ¬åœ°ç¼“å­˜ã€é¿å…é‡å¤åŠ è½½

##### ç½‘é¡µåŠ è½½é˜¶æ®µåˆ†æ

1. ç½‘é¡µèµ„æºè¯·æ±‚ä¸åŠ è½½é˜¶æ®µ ( DevTools æŸ¥çœ‹è¯·æ±‚å„é˜¶æ®µè€—æ—¶)

   - æµè§ˆå™¨å¯¹æ¯ä¸ªæºå…è®¸çš„ TCP è¿æ¥æ•°é‡é™åˆ¶

     > ç°çŠ¶ï¼šChrome åŸºäº `http`åªå…è®¸ 6 ä¸ª TCP åŒä¸€æ—¶åˆ»è¿æ¥åŒä¸€æº
     >
     > æ–¹æ¡ˆï¼š
     >
     > - å°†å¤šä¸ªèµ„æºåˆ†å¸ƒåœ¨ä¸åŒçš„å­åŸŸåä¸Šï¼Œå‡å°‘è¯·æ±‚é˜Ÿåˆ—çš„ç­‰å¾…æ—¶é—´ï¼›
     > - ä½†ä¸åŒçš„åŸŸï¼Œéœ€è¦ä¸åŒçš„ DNS åŸŸåè§£æè¿‡ç¨‹ï¼ˆé€šå¸¸åˆ’åˆ†ä¸º 3-5 ä¸ªåŸŸåæ¯”è¾ƒåˆé€‚ï¼‰
     > - DNS è§£æè®°å½•ä¼šåœ¨æµè§ˆå™¨ä¸­è¿›è¡Œç¼“å­˜ï¼Œå› æ­¤æ¨èä½¿ç”¨ `å…¬å…±CDNæ‰˜ç®¡`

2. ç½‘é¡µæ¸²æŸ“é˜¶æ®µ( DevTools æŸ¥çœ‹ç½‘é¡µæ¸²æŸ“å„éƒ¨åˆ†è€—æ—¶`Paining\Rendering`)

   - è·å– HTML ç”Ÿæˆ DOM æ ‘ï¼ŒåŒæ—¶ä¸‹è½½ cssã€js æ–‡ä»¶

   - å°† CSS è§£æä¸º`CSSOM å±‚å æ ·å¼è¡¨æ¨¡å‹`

     > è¿‡äºå¤æ‚çš„ css åµŒå¥—è§„åˆ™ä¼šå½±å“ CSSOM çš„ç”Ÿæˆï¼Œå¯¼è‡´æ¸²æŸ“æ—¶é—´å»¶é•¿

   - JS å¼•æ“å¤„ç† JS

     > å¦‚æœåœ¨é¡µé¢æ¸²æŸ“æ—¶ï¼Œä½¿ç”¨ JS æ“ä½œ DOMï¼Œåˆ™ä¼šé˜»å¡æ¸²æŸ“
     >
     > æ¨èæ–¹æ¡ˆï¼šå°† Js ä»£ç æ”¾åœ¨é¡µé¢ä»£ç åº•éƒ¨ `</body>`å‰

   - å°† DOM å’Œ CSSOM æ„å»ºæˆä¸º`æ¸²æŸ“æ ‘`ï¼Œç”Ÿæˆç”¨æˆ·ç•Œé¢











### å­—ä½“å‹ç¼©

#### [fontâˆ’spider](https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Faui%2Ffont-spider%2Fblob%2FHEAD%2FREADME-ZH-CN.md) 

> æ™ºèƒ½ WebFont å‹ç¼©å·¥å…·ï¼Œå®ƒèƒ½è‡ªåŠ¨åˆ†æå‡ºé¡µé¢ä½¿ç”¨çš„ WebFont å¹¶è¿›è¡ŒæŒ‰éœ€å‹ç¼©
>
> - [aui/font-spider (github.com)](https://github.com/aui/font-spider/blob/HEAD/README-ZH-CN.md)
> - [ttf å­—ä½“åŒ…å‹ç¼©ä¼˜åŒ– - æ˜é‡‘ (juejin.cn)](https://juejin.cn/post/7161359760023879693)
> - æ›´ç®€å•çš„åœ¨çº¿å­—ä½“å‹ç¼©å·¥å…·ï¼š

```js
// 1.å®‰è£…
npm install font-spider -g

// 2.æ–°å»ºç”¨äºè½¬æ¢æ–‡æœ¬çš„ html æ–‡ä»¶ï¼ŒæŠŠéœ€è¦ç”¨çš„æ–‡æ¡ˆç²˜è´´è¿›å»
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <style>
    @font-face {
      font-family: 'convert-font';
      /* src: url('./Alibaba-PuHuiTi-Bold.ttf') format('truetype'); */
      src: url('./Alibaba-PuHuiTi-Medium.ttf') format('truetype');
      font-weight: normal;
      font-style: normal;
    }

    .convert-font {
      font-family: 'convert-font';
    }
  </style>
</head>
<body>
  <div>
    Lorem ipsum dolor sit amet consectetur, adipisicing elit. Quam quos minima autem animi quae itaque assumenda doloribus, similique dicta sequi, molestias tenetur quaerat qui suscipit ducimus labore, saepe debitis adipisci!
  </div>
  </br>
  <div class="convert-font">
    Lorem ipsum dolor sit amet consectetur adipisicing elit. Blanditiis amet error quae perferendis eum repellendus
    necessitatibus quod, minus commodi? Quis eaque iusto distinctio libero eos architecto deserunt mollitia, aliquid
    tempora.
  </div>
</body>
</html>

// 3.åœ¨è¯¥é¡¹ç›®æ–‡ä»¶å¤¹å†…æ‰§è¡Œå‘½ä»¤
font-spider index.html
    
// 4.æŸ¥çœ‹å¹¶ä½¿ç”¨æ–‡ä»¶å¤¹å†…æ–°å¢çš„ .font-spider ä¸­æ–‡ä»¶
```







## PWA

> æ¸è¿›å¼webåº”ç”¨ï¼Œç»™ç”¨æˆ·åŸç”Ÿå¼•ç”¨ä½“éªŒï¼›è¿ç”¨ç°ä»£çš„Web ApiåŠä¼ ç»Ÿçš„æ¸è¿›å¼å¢å¼ºç­–ç•¥åˆ›å»ºè·¨å¹³å°webåº”ç”¨ç¨‹åºã€‚
>
> - https://developer.mozilla.org/zh-CN/docs/Web/Progressive_web_apps/Guides/Caching
> - https://www.pwabuilder.com/

- ä¼˜åŠ¿
  - æ¸è¿›å¼ï¼Œé€‚ç”¨äºæ‰€æœ‰æµè§ˆå™¨
  - æµç•…ï¼Œèƒ½å¤Ÿå€ŸåŠ©Service Workeråœ¨ç¦»çº¿æˆ–è€…ç½‘ç»œè¾ƒå·®çš„æƒ…å†µä¸‹æ­£å¸¸è®¿é—®
  - å¯å®‰è£…ã€å…·å¤‡åŸç”Ÿä½“éªŒï¼šé¦–å±åŠ è½½åŠ¨ç”»ã€éšè—åœ°å€æ ç­‰
  - ç²˜æ€§ï¼šé€šè¿‡æ¨é€ç¦»çº¿é€šçŸ¥ï¼Œè®©ç”¨æˆ·å›æµ
- PWAåº”ç”¨ ä¸‰è¦ç´ 
  - HTTPS æœåŠ¡æ”¯æŒ
  - manifest.json æ¸…å•
  - service worker





### manifestæ¸…å•

- web app manifest åº”ç”¨ç¨‹åºæ¸…å•
  - ä½œç”¨ï¼šæä¾›æœ‰å…³åº”ç”¨çš„é…ç½®ä¿¡æ¯
  - æ³¨æ„ï¼š
    - éœ€è¦åœ¨httpsåè®®ä¸‹æ‰èƒ½è®¿é—®ï¼ï¼ï¼

```js
// 1.åœ¨é¡¹ç›®æ›´ç›®å½• åˆ›å»ºmanifest.jsonæ–‡ä»¶
// 2.åœ¨index.htmlä¸­å¼•å…¥ manifest.json
<link ref='manifest' href='manifest.json' />
    
    
// 3.manifesté…ç½®ä¿¡æ¯;
name:'åº”ç”¨åç§°';	// ç”¨æˆ·å®‰è£…æ¨ªå¹…æç¤ºçš„åç§°ï¼Œå’Œå¯åŠ¨ç”»é¢çš„æ–‡å­—
short_name:'åº”ç”¨çš„çŸ­åç§°'; // ç”¨äºä¸»å±å¹•å±•ç¤º
description:''; // æè¿°
start_url:'/'; // æŒ‡å®šç”¨æˆ·è®¾å¤‡å¯åŠ¨æ—¶åŠ è½½çš„urlï¼Œç»å¯¹è·¯å¾„/ç›¸å¯¹è·¯å¾„
icons:[]; // åœ¨å„ç§ç¯å¢ƒä¸­åº”ç”¨ç¨‹åºå›¾æ ‡çš„å¯¹è±¡æ•°ç»„
background_color:''; // æŒ‡å®šç”¨æˆ·å¯åŠ¨åŠ¨ç”»çš„èƒŒæ™¯é¢œè‰²
theme_color:''; // æŒ‡å®šåº”ç”¨ç¨‹åºçš„ä¸»é¢˜é¢œè‰²
display:'' // æŒ‡å®šåº”ç”¨ç¨‹åºçš„æ˜¾ç¤ºæ¨¡å¼
// - fullscreen å…¨å±æ˜¾ç¤ºï¼Œä¸æ˜¾ç¤ºçŠ¶æ€æ 
// - standalone æ›´åƒåŸç”ŸApp
// - minimal-ui ä¿ç•™æµè§ˆå™¨æ 
```





### ServiceWorker

> - [ã€æ€§èƒ½ä¼˜åŒ–ã€‘Service Worker èƒ½åšçš„è¿œæ¯”ä½ æƒ³è±¡çš„å¤š - æ˜é‡‘ (juejin.cn)](https://juejin.cn/post/7067113836372819982)
> - [vite pwaé¡¹ç›®ä½¿ç”¨ - æ˜é‡‘ (juejin.cn)](https://juejin.cn/post/7039258299086143524#heading-1)
> - [æ·»åŠ é…ç½®é¡¹ Â· imsyy/home@ddda08c (github.com)](https://github.com/imsyy/home/commit/ddda08c03770ce8845ef10b354338f713ffa3e81)

- 14å¹´æå‡ºçš„ HTML5 APIï¼Œä¸»è¦ç”¨æ¥åšæŒä¹…çš„ç¦»çº¿ç¼“å­˜
- ç‰¹ç‚¹
  - å…è®¸webåº”ç”¨åœ¨ç½‘ç»œè¾ƒå·®æˆ–ç¦»çº¿ç¯å¢ƒä¸‹ä¾æ—§å¯ä»¥ä½¿ç”¨ï¼Œé™æ€èµ„æºä¼˜å…ˆè¯»ç¼“å­˜æˆ–ä¸å¸¸å˜æ›´çš„èµ„æºä¼˜å…ˆè¯»å–ç¼“å­˜
  - æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„workerçº¿ç¨‹ï¼Œç›¸å½“äºå½“å‰ç½‘é¡µè¿›ç¨‹ï¼Œæ˜¯ä¸€ç§ç‰¹æ®Šçš„webworker
  - ä¸€æ—¦è¢«installå°±æ°¸è¿œå­˜åœ¨ï¼Œé™¤éè¢«æ‰‹åŠ¨ unregister
  - ç‹¬ç«‹äºä¸»çº¿ç¨‹ä¹‹å¤–ï¼Œä½¿ç”¨æ—¶è¢«å”¤é†’ï¼Œä¸ä½¿ç”¨æ—¶è‡ªåŠ¨ä¼‘çœ 
  - å¯ç¼–ç¨‹æ‹¦æˆªä»£ç†è¯·æ±‚å’Œè¿”å›ï¼Œç¼“å­˜çš„æ–‡ä»¶å¯ä»¥è¢«ç½‘é¡µè¿›ç¨‹å–åˆ°(åŒ…æ‹¬ç¦»çº¿çŠ¶æ€)
  - ç¦»çº¿å†…å®¹å¼€å‘è€…å¯æ§
  - å¿…é¡»åœ¨HTTPSç¯å¢ƒä¸‹å·¥ä½œ
  - å¼‚æ­¥å®ç°ï¼Œå†…éƒ¨å¤§éƒ½æ˜¯é€šè¿‡Promiseå®ç°
- ç”Ÿå‘½å‘¨æœŸ
  - install åœ¨serviceWorkeræ³¨å†ŒæˆåŠŸæ—¶è§¦å‘ï¼Œä¸»è¦ç”¨äºç¼“å­˜èµ„æº
  - activate åœ¨serviceWorkeræ¿€æ´»æ—¶è§¦å‘ï¼Œç”¨äºåˆ é™¤æ—§çš„èµ„æº
  - fetch å‘é€è¯·æ±‚æ—¶è§¦å‘ï¼Œç”¨äºæ“ä½œç¼“å­˜æˆ–è¯»å–ç½‘ç»œèµ„æº
- æ³¨æ„
  - sw.js æ–‡ä»¶å‘ç”Ÿå˜åŒ–æ—¶ï¼Œinstall ä¼šé‡æ–°è§¦å‘
  - activate äº‹ä»¶ä¼šåœ¨installäº‹ä»¶åè§¦å‘ï¼Œä½†ç”±äºsw.jsæ–‡ä»¶æ”¹å˜å¼•èµ·çš„installäº‹ä»¶ä¸­ç”±äºserviceWorkerå·²ç»å­˜åœ¨ï¼Œå°±ä¼šå¤„äºç­‰å¾…çŠ¶æ€ï¼Œç›´åˆ°å½“å‰serviceWorkerç»ˆæ­¢
    - å¯é€šè¿‡`self.skipWaiting()`æ–¹æ³•è·³è¿‡ç­‰å¾…ï¼Œè¿”å›Promiseå¯¹è±¡
    - é€šè¿‡`self.waitUntil()`æ–¹æ³•ç»“æŸä¸€ä¸ªPomiseå¯¹è±¡ï¼Œä¼šåœ¨Promsieç»“æŸåç»“æŸå½“å‰ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œé˜²æ­¢æµè§ˆå™¨åœ¨å¼‚æ­¥æ“ä½œä¹‹å‰å°±åœæ­¢äº†ç”Ÿå‘½å‘¨æœŸã€‚
  - æ³¨å†ŒserviceWorkeré»˜è®¤åœ¨ä¸‹æ¬¡åˆ·æ–°é¡µé¢æ—¶æ‰ç”Ÿæ•ˆï¼›`claim()`æ–¹æ³•ä¼šç«‹å³æ§åˆ¶è¿™äº›é¡µé¢

```js
// åœ¨window.onload ä¸­æ³¨å†Œ service worker,é˜²æ­¢ä¸å…¶ä»–èµ„æºç«äº‰
// navigatorå¯¹è±¡ä¸­å†…ç½®äº† serviceWorkerå±æ€§
// å…¼å®¹æ€§åˆ¤æ–­ï¼š if('serviceWorker' in navigator){}
// registeræ³¨å†ŒserviceWorkerï¼Œè¿”å›Promiseå¯¹è±¡

// index.html
window.onload = ()=>{
    if('serviceWorker' in navigator){
        navigator.serviceWorker.register('./sw.js')
            .then(resitration=>{console.log(resitration)})
        	.catch(err=>{console.log(err)})
    }
}

// sw.js 
self.addEventListener('insatll',event=>{
    // ç­‰å¾…skipWaitingè·³è¿‡ç­‰å¾…ç»“æŸï¼Œå†è§¦å‘activateäº‹ä»¶
    event.waitUntil(self.skipWaiting())
})

self.addEventListener('activate',event=>{
    // è¡¨ç¤ºserviceWorkeæ¿€æ´»åï¼Œç«‹å³è·å–æ§åˆ¶æƒ
    event.waitUntil(self.clients.claim())
})

self.addEventListener('fetch',event=>{
    //
})
```





### CacheStorageç¼“å­˜

![image-20241120173054332](images/%E5%85%B6%E4%BB%96%E6%A6%82%E5%BF%B5/image-20241120173054332.png)



### notificationé€šçŸ¥







### æ›´ç°ä»£çš„PWAåšæ³•

- https://vite-pwa-org.netlify.app/
- https://www.pwabuilder.com/
- ![image-20241120181027103](images/%E5%85%B6%E4%BB%96%E6%A6%82%E5%BF%B5/image-20241120181027103.png)









## WebAssembly

> äº†è§£AssemblyScriptï¼šåŸºäºTSçš„è¯­è¨€ï¼Œå¯ç¼–è¯‘ä¸ºWebAssembly  ?

- ç‰¹ç‚¹ï¼š
  - WebAssemblyä¸€ç§æ–°çš„ç¼–ç æ–¹å¼ï¼Œå±äºä½çº§çš„ç±»æ±‡ç¼–è¯­è¨€ï¼Œå…·å¤‡ç´§å‡‘çš„äºŒè¿›åˆ¶æ ¼å¼ï¼Œæ¥è¿‘åŸç”Ÿæ€§èƒ½è¿è¡Œï¼Œç¼–è¯‘å…¶ä»–è¯­è¨€å¹¶åœ¨ Webè¿è¡Œã€‚å¯ä¸ JavaScript ååŒå·¥ä½œã€‚
  - ç¼–è¯‘å’Œä¼˜åŒ–ï¼šwasmæ˜¯ä½“ç§¯å°ä¸”åŠ è½½å¿«çš„äºŒè¿›åˆ¶æ ¼å¼ï¼Œç”¨äºå……åˆ†å‘æŒ¥ç¡¬ä»¶èƒ½åŠ›ä»¥è¾¾åˆ°åŸç”Ÿæ‰§è¡Œæ•ˆç‡
  - å¯ä½¿ç”¨é JavaScript ç¼–ç¨‹è¯­è¨€ç¼–å†™ä»£ç åœ¨æµè§ˆå™¨è¿è¡Œçš„æŠ€æœ¯æ–¹æ¡ˆï¼Œæ˜¯ä¸€ç§æ–°çš„å­—èŠ‚ç æ ¼å¼ã€‚æœ€ç»ˆç¼–è¯‘ä¸º`.wasm`æ–‡ä»¶
  - å¿«é€Ÿã€é«˜æ•ˆã€å¯ç§»æ¤ã€é™åˆ¶åœ¨å®‰å…¨æ²™ç®±ä¸­è¿è¡Œï¼Œéµå¾ªæµè§ˆå™¨çš„åŒæºç­–ç•¥å’Œæˆæƒç­–ç•¥
  - wasmæ–‡ä»¶ä½“ç§¯æ›´å°ï¼Œä¸‹è½½é€Ÿåº¦æ›´å¿«ï¼Œè§£ææ¯”JSæ›´å¿«
  -  WebAssemblyæ¨¡å— åœ¨å¾ˆå¤šæ–¹é¢å’Œ ESæ¨¡å—ç­‰ä»·
  - JavaScript API ä¸ºå¼€å‘è€…æä¾›äº†åˆ›å»ºæ¨¡å—ã€å†…å­˜ã€è¡¨æ ¼å’Œå®ä¾‹çš„èƒ½åŠ›
  - ä»»æ„çš„ JavaScript å‡½æ•°éƒ½èƒ½è¢« WebAssembly ä»£ç å¯¼å…¥å¹¶åŒæ­¥è°ƒç”¨
- å¯èƒ½çš„ç”±æ¥
  - 3D æ¸¸æˆã€è™šæ‹Ÿç°å®ã€å¢å¼ºç°å®ã€è®¡ç®—æœºè§†è§‰ã€å›¾åƒ/è§†é¢‘ç¼–è¾‘ç­‰å¤§é‡è¦æ±‚åŸç”Ÿæ€§èƒ½çš„é¢†åŸŸä¸­JSæ€§èƒ½å—é™
- ç›¸å…³æ¦‚å¿µ
  - æ¨¡å—ï¼šè¢«æµè§ˆå™¨ç¼–è¯‘ä¸ºå¯æ‰§è¡Œæœºå™¨ç çš„WebAssemblyäºŒè¿›åˆ¶ä»£ç ï¼›æ— çŠ¶æ€çš„ï¼›æ”¯æŒåƒESæ¨¡å—çš„å£°æ˜å¯¼å…¥å¯¼å‡º
  - å†…å­˜ï¼šå¯å˜é•¿çš„ArrayBufferã€‚æœ¬è´¨ä¸Šæ˜¯è¿ç»­çš„å­—èŠ‚æ•°ç»„ã€‚WebAssembly çš„ä½çº§å†…å­˜å­˜å–æŒ‡ä»¤å¯è¿›è¡Œè¯»å†™æ“ä½œã€‚
  - è¡¨æ ¼ï¼šå¯å˜é•¿çš„ç±»å‹åŒ–æ•°ç»„ï¼Œå­˜å‚¨ä¸èƒ½ä½œä¸ºåŸå§‹å­—èŠ‚å­˜å‚¨åœ¨å†…å­˜é‡Œçš„å¯¹è±¡çš„å¼•ç”¨ã€‚
  - å®ä¾‹ï¼šæ¨¡å—åŠå…¶åœ¨è¿è¡Œæ—¶ä½¿ç”¨çš„æ‰€æœ‰çŠ¶æ€ï¼ŒåŒ…æ‹¬å†…å­˜ã€è¡¨æ ¼å’Œä¸€ç³»åˆ—å¯¼å…¥å€¼ã€‚
- å…¥é—¨
  - ä½¿ç”¨ [Emscripten](https://emscripten.org/) ç§»æ¤ä¸€ä¸ª C/C++ åº”ç”¨ç¨‹åºã€‚
  - ç›´æ¥åœ¨æ±‡ç¼–å±‚ï¼Œç¼–å†™æˆ–ç”Ÿæˆ WebAssembly ä»£ç ã€‚ã€ç•¥ã€‘
  - ç¼–å†™ Rust ç¨‹åºï¼Œå°† WebAssembly ä½œä¸ºå®ƒçš„è¾“å‡ºã€‚
  - ä½¿ç”¨ [AssemblyScript](https://www.assemblyscript.org/)ï¼Œå®ƒç±»ä¼¼äº TypeScript å¹¶ä¸”å¯ç¼–è¯‘æˆäºŒè¿›åˆ¶ WebAssembly ä»£ç ã€‚







### [JSæ¥å£](https://developer.mozilla.org/zh-CN/docs/WebAssembly/JavaScript_interface)

- æ–¹æ³•
  - [`WebAssembly.instantiate()`](https://developer.mozilla.org/zh-CN/docs/WebAssembly/JavaScript_interface/instantiate_static)   ç¼–è¯‘å’Œå®ä¾‹åŒ– WebAssembly ä»£ç ï¼Œè¿”å›ä¸€ä¸ª `Module` å’Œç¬¬ä¸€ä¸ª`Instance`å®ä¾‹
  - [`WebAssembly.instantiateStreaming()`](https://developer.mozilla.org/zh-CN/docs/WebAssembly/JavaScript_interface/instantiateStreaming_static) ã€æ¨èã€‘ç›´æ¥ä»æµå¼åº•å±‚æºç¼–è¯‘å’Œå®ä¾‹åŒ– WebAssembly æ¨¡å—
  - [`WebAssembly.compile()`](https://developer.mozilla.org/zh-CN/docs/WebAssembly/JavaScript_interface/compile_static)  æŠŠ WebAssembly äºŒè¿›åˆ¶ä»£ç ç¼–è¯‘ä¸ºä¸€ä¸ª [`WebAssembly.Module`](https://developer.mozilla.org/zh-CN/docs/WebAssembly/JavaScript_interface/Module) ï¼Œä¸è¿›è¡Œå®ä¾‹åŒ–
  - [`WebAssembly.compileStreaming()`](https://developer.mozilla.org/zh-CN/docs/WebAssembly/JavaScript_interface/compileStreaming_static)  ç›´æ¥ä»æµå¼åº•å±‚æºä»£ç ç¼–è¯‘[`WebAssembly.Module`](https://developer.mozilla.org/zh-CN/docs/WebAssembly/JavaScript_interface/Module) ï¼Œå°†å®ä¾‹åŒ–ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„æ­¥éª¤
  - [`WebAssembly.validate()`](https://developer.mozilla.org/zh-CN/docs/WebAssembly/JavaScript_interface/validate_static)    æ ¡éªŒ WebAssembly äºŒè¿›åˆ¶ä»£ç çš„ç±»å‹æ•°ç»„æ˜¯å¦åˆæ³•ï¼Œåˆæ³•åˆ™è¿”å› trueï¼Œå¦åˆ™è¿”å› false
- æ„é€ å™¨
  - [`WebAssembly.Global()`](https://developer.mozilla.org/zh-CN/docs/WebAssembly/JavaScript_interface/Global)   åˆ›å»ºä¸€ä¸ªæ–°çš„ WebAssembly `Global` å…¨å±€å¯¹è±¡ã€‚
  - [`WebAssembly.Module()`](https://developer.mozilla.org/zh-CN/docs/WebAssembly/JavaScript_interface/Module)   åˆ›å»ºä¸€ä¸ªæ–°çš„ WebAssembly `Module`æ¨¡å—å¯¹è±¡ã€‚
  - [`WebAssembly.Instance()`](https://developer.mozilla.org/zh-CN/docs/WebAssembly/JavaScript_interface/Instance)	åˆ›å»ºä¸€ä¸ªæ–°çš„ WebAssembly `Instance`å®ä¾‹å¯¹è±¡ã€‚
  - [`WebAssembly.Memory()`](https://developer.mozilla.org/zh-CN/docs/WebAssembly/JavaScript_interface/Memory)   åˆ›å»ºä¸€ä¸ªæ–°çš„ WebAssembly `Memory`å†…å­˜å¯¹è±¡ã€‚
  - [`WebAssembly.Table()`](https://developer.mozilla.org/zh-CN/docs/WebAssembly/JavaScript_interface/Table)	åˆ›å»ºä¸€ä¸ªæ–°çš„ WebAssembly `Table`è¡¨æ ¼å¯¹è±¡ã€‚
  - [`WebAssembly.CompileError()`](https://developer.mozilla.org/zh-CN/docs/WebAssembly/JavaScript_interface/CompileError)	åˆ›å»ºä¸€ä¸ªæ–°çš„ WebAssembly `CompileError`ç¼–è¯‘é”™è¯¯å¯¹è±¡ã€‚
  - [`WebAssembly.LinkError()`](https://developer.mozilla.org/en-US/docs/WebAssembly/JavaScript_interface/LinkError)	åˆ›å»ºä¸€ä¸ªæ–°çš„ WebAssembly `LinkError`é“¾æ¥é”™è¯¯å¯¹è±¡ã€‚
  - [`WebAssembly.RuntimeError()`](https://developer.mozilla.org/zh-CN/docs/WebAssembly/JavaScript_interface/RuntimeError)	åˆ›å»ºä¸€ä¸ªæ–°çš„ WebAssembly `RuntimeError`è¿è¡Œæ—¶é”™è¯¯å¯¹è±¡ã€‚









### C/C++ç§»æ¤

> - åœ¨çº¿ç¼–è¾‘    https://anonyco.github.io/WasmFiddlePlusPlus/
> - Emscripten   https://emscripten.org/
> - MDNæ–‡æ¡£    https://developer.mozilla.org/zh-CN/docs/WebAssembly/C_to_Wasm

- Emscripten å·¥å…·å¯ä»¥å°†ä»»ä½• C/C++ æºä»£ç ç¼–è¯‘æˆ Wasm æ¨¡å—





#### Emscripten 

> Emscripten å·¥å…·å¯ä»¥å°†ä»»ä½• C/C++ æºä»£ç ç¼–è¯‘æˆ Wasm æ¨¡å—ï¼Œå†åŠ ä¸Šå¿…è¦çš„ JavaScript ç²˜åˆä»£ç ï¼Œç”¨äºåŠ è½½å’Œè¿è¡Œæ¨¡å—ï¼Œä»¥åŠæ˜¾ç¤ºä»£ç ç»“æœçš„ HTML æ–‡æ¡£ã€‚
>
> ![img](images/%E5%85%B6%E4%BB%96%E6%A6%82%E5%BF%B5/emscripten-diagram.png)

- å·¥ä½œæµ
  1. Emscripten é¦–å…ˆæŠŠ C/C++ æä¾›ç»™ `clang+LLVM â€”â€” æˆç†Ÿçš„å¼€æº C/C++ ç¼–è¯‘å™¨å·¥å…·é“¾`
  2. Emscripten å°† clang+LLVM ç¼–è¯‘çš„ç»“æœè½¬æ¢ä¸º Wasm äºŒè¿›åˆ¶æ–‡ä»¶
  3. WebAssembly æœ¬èº«æ— æ³•ç›´æ¥è®¿é—® DOMï¼›å®ƒåªèƒ½è°ƒç”¨ JavaScriptï¼Œå¹¶ä¸”åªèƒ½ä¼ å…¥æ•´å‹å’Œæµ®ç‚¹å‹çš„åŸå§‹æ•°æ®ç±»å‹ä½œä¸ºå‚æ•° ã€ è®¡åˆ’å°†æ¥[å…è®¸ WebAssembly ç›´æ¥è°ƒç”¨ Web API](https://github.com/WebAssembly/gc/blob/master/README.md) ã€‘





### Rustç§»æ¤

- ä¸¤å¤§ä¸»è¦ç”¨ä¾‹
  - æ„å»ºå®Œæ•´åº”ç”¨â€”â€”æ•´ä¸ª Web åº”ç”¨éƒ½åŸºäº Rust å¼€å‘ï¼   å‚è€ƒ[`yew`](https://github.com/DenisKolodin/yew)é¡¹ç›®
  - æ„å»ºåº”ç”¨çš„ç»„æˆéƒ¨åˆ†â€”â€”åœ¨ç°å­˜çš„ JavaScript å‰ç«¯ä¸­ä½¿ç”¨ Rustã€é‡ç‚¹ã€‘
- MDNæ–‡æ¡£ï¼š https://developer.mozilla.org/zh-CN/docs/WebAssembly/Rust_to_Wasm











### [AssemblyScript](https://www.assemblyscript.org/)

> - å°† TypeScript çš„ä¸¥æ ¼å˜ä½“ç¼–è¯‘ä¸º WebAssemblyï¼Œè®©ç½‘ç»œå¼€å‘è€…å¯ä»¥ç»§ç»­ä½¿ç”¨ä»–ä»¬ç†Ÿæ‚‰çš„ TypeScript å…¼å®¹å·¥å…·ï¼Œå¦‚ Prettierã€ESLintã€VS Code IntelliSense ç­‰
> - https://www.assemblyscript.org/
> - é’ˆå¯¹WebAssembly çš„åŠŸèƒ½é›†ã€ä¸ TypeScript çš„ç›¸ä¼¼æ€§ã€ä¸ç°æœ‰çš„Web ç”Ÿæ€ç³»ç»Ÿé›†æˆ 





